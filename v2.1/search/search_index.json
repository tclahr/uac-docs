{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to the Unix-like Artifacts Collector documentation UAC is a Live Response collection tool for Incident Response that makes use of native binaries to automate the collection of Unix-like systems artifacts. It was created to facilitate and speed up data collection, and depend less on remote support during incident response engagements. UAC reads artifacts files on the fly and, based on their contents, collects relevant artifacts. This makes UAC very customizable and extensible. The source code is available from the project page . Main features Runs everywhere with no dependencies (no installation required). Customizable and extensible collections and artifacts. Respects the order of volatility during artifacts collection. Collects information from processes running without a binary on disk. Extracts information from files and directories to create a bodyfile (including enhanced file attributes for ext4). Hashes running processes and executable files. Collects user and system configuration files and logs. Collects artifacts from applications. Acquires volatile memory from Linux systems using Microsoft's avml tool. Supported operating systems UAC runs on any Unix-like system (regardless the processor architecture). All UAC needs is shell :) AIX Android FreeBSD Linux macOS NetBSD NetScaler OpenBSD Solaris Command line options UAC is a command line tool, and as such, has several options that can be used to interact with it. It is recommended to run UAC from an external device/usb/network share to avoid overwriting evidence. Usage: ./uac [-h] [-V] [--debug] {-p PROFILE | -a ARTIFACTS} DESTINATION [-m MOUNT_POINT] [-s OPERATING_SYSTEM] [-u] [--temp_dir PATH] [--date-range-start YYYY-MM-DD] [--date-range-start YYYY-MM-DD] [--case-number CASE_NUMBER] [--description DESCRIPTION] [--evidence-number EVIDENCE_NUMBER] [--examiner EXAMINER] [--notes NOTES] [--hostname HOSTNAME] [--stfp SERVER] [--sftp-port PORT] [--sftp-identity-file FILE] [--sftp-delete-local-on-success] [--debug] or: ./uac --validate-artifacts-file FILE Optional Arguments: -h, --help Display this help and exit. -V, --version Output version information and exit. --debug Enable debug mode. Profiling Arguments: -p, --profile PROFILE Specify the collection profile name. Use '--profile list' to list available profiles. -a, --artifacts ARTIFACTS Specify the artifacts to be collected during the collection. The expression is a comma separated string where each element is an artifact file. Each element can be prepended with an exclamation mark to exclude the artifact. Special characters such as ! and * must be escaped with a backslash. Examples: --artifacts files/logs/\\*,\\!files/logs/var_log.yaml Use '--artifacts list' to list available artifacts. Positional Arguments: DESTINATION Specify the directory the output file will be created in. Collection Arguments: -m, --mount-point MOUNT_POINT Specify the mount point (default: /). -s, --operating-system OPERATING_SYSTEM Specify the operating system. Options: aix, android, freebsd, linux, macos, netbsd netscaler, openbsd, solaris -u, --run-as-non-root Disable root user check. Note that data collection may be limited. --temp-dir PATH Write all temporary data to this directory. Filter Arguments: --date-range-start YYYY-MM-DD Only collects files that were last modified/accessed/changed after given date. --date-range-end YYYY-MM-DD Only collects files that were last modified/accessed/changed before given date. Informational Arguments: --case-number CASE_NUMBER Specify the case number. --description DESCRIPTION Specify the description. --evidence-number EVIDENCE_NUMBER Specify the evidence number. --examiner EXAMINER Specify the examiner name. --notes NOTES Specify the notes. --hostname HOSTNAME Specify the target system hostname. Remote Transfer Arguments: --sftp SERVER Transfer output file to remote SFTP server. SERVER must be specified in the form [user@]host:[path] --sftp-port PORT Remote SFTP server port (default: 22). --sftp-identity-file FILE File from which the identity (private key) for public key authentication is read. --sftp-delete-local-on-success Delete local output file on successful transfer. Validation Arguments: --validate-artifacts-file FILE Validate artifacts file. Using UAC A profile name or a list of artifacts , and the destination directory need to be provided in order to run a collection. The remaining parameters are optional. Common usage scenarios may include the following: Collect all artifacts based on the full profile, and create the output file in /tmp . ./uac -p full /tmp Collect all live_response , and the bodyfile/bodyfile.yaml artifact, and create the output file in the current directory. ./uac -a live_response/\\*,bodyfile/bodyfile.yaml . Collect all artifacts based on the full profile, but excludes the bodyfile/bodyfile.yaml artifact, and create the output file in /tmp . ./uac -p full -a \\!bodyfile/bodyfile.yaml /tmp Note that when a profile and a list of artifacts are provided, the artifacts from the profile will always be collected first, even if the parameter -a was provided before -p in the command line. In the example below, the memory_dump/avml.yaml artifact will only be collected after all artifacts from full profile were collected. ./uac -a memory_dump/avml.yaml -p full /tmp Collect all artifacts based on the full profile, but limiting the data collection based on the date range provided. ./uac -p full /tmp --date-range-start 2021-05-01 --date-range-end 2021-08-31 Collect all but live response artifacts from a Linux disk image mounted in /mnt/ewf . ./uac -p full -a \\!live_response/\\* /tmp --mount-point /mnt/ewf --operating-system linux Validating custom artifacts files It is recommended that you validate your custom artifacts files before running a collection. You can do it using the --validate-artifacts-file option as shown below. ./uac --validate-artifacts-file ./artifacts/files/my_custom_artifact.yaml Using your own binary files Place your validated binary files in the [uac_directory]\\bin directory if you want them to be executed instead of the built-in ones provided by the target operating system. UAC will detect and run CPU architecture specific executable files, so they need to be placed within the following directory structure: [uac_directory]\\bin\\[operating_system]\\[architecture] . Operating system must be one of the following options (in lowercase): android, aix, freebsd, linux, macos, netbsd, netscaler, openbsd or solaris. Architecture is the kernel architecture (in lowercase). It can be retrieved using uname tool. For example: if you have a ss binary for Linux x86_64, it needs to be placed in the [uac_directory]\\bin\\linux\\x86_64 directory. if you have a lsof binary for AIX powerpc, it needs to be placed in the [uac_directory]\\bin\\aix\\powerpc directory. if you have a netstat binary for Android aarch64, it needs to be placed in the [uac_directory]\\bin\\android\\aarch64 directory. Troubleshooting and support Debug mode Debug mode --debug may be useful if you are trying to find the source for an error. When debug mode is on, UAC will use set -x to generate debugging messages, and store them into uac.log.stderr file. File an issue on Github If you are experiencing an issue with UAC, you can create a New Issue at the project page . See the Github guide on creating an issue for more information. License The UAC project uses the Apache License Version 2.0 software license.","title":"Getting started"},{"location":"#welcome-to-the-unix-like-artifacts-collector-documentation","text":"UAC is a Live Response collection tool for Incident Response that makes use of native binaries to automate the collection of Unix-like systems artifacts. It was created to facilitate and speed up data collection, and depend less on remote support during incident response engagements. UAC reads artifacts files on the fly and, based on their contents, collects relevant artifacts. This makes UAC very customizable and extensible. The source code is available from the project page .","title":"Welcome to the Unix-like Artifacts Collector documentation"},{"location":"#main-features","text":"Runs everywhere with no dependencies (no installation required). Customizable and extensible collections and artifacts. Respects the order of volatility during artifacts collection. Collects information from processes running without a binary on disk. Extracts information from files and directories to create a bodyfile (including enhanced file attributes for ext4). Hashes running processes and executable files. Collects user and system configuration files and logs. Collects artifacts from applications. Acquires volatile memory from Linux systems using Microsoft's avml tool.","title":"Main features"},{"location":"#supported-operating-systems","text":"UAC runs on any Unix-like system (regardless the processor architecture). All UAC needs is shell :) AIX Android FreeBSD Linux macOS NetBSD NetScaler OpenBSD Solaris","title":"Supported operating systems"},{"location":"#command-line-options","text":"UAC is a command line tool, and as such, has several options that can be used to interact with it. It is recommended to run UAC from an external device/usb/network share to avoid overwriting evidence. Usage: ./uac [-h] [-V] [--debug] {-p PROFILE | -a ARTIFACTS} DESTINATION [-m MOUNT_POINT] [-s OPERATING_SYSTEM] [-u] [--temp_dir PATH] [--date-range-start YYYY-MM-DD] [--date-range-start YYYY-MM-DD] [--case-number CASE_NUMBER] [--description DESCRIPTION] [--evidence-number EVIDENCE_NUMBER] [--examiner EXAMINER] [--notes NOTES] [--hostname HOSTNAME] [--stfp SERVER] [--sftp-port PORT] [--sftp-identity-file FILE] [--sftp-delete-local-on-success] [--debug] or: ./uac --validate-artifacts-file FILE Optional Arguments: -h, --help Display this help and exit. -V, --version Output version information and exit. --debug Enable debug mode. Profiling Arguments: -p, --profile PROFILE Specify the collection profile name. Use '--profile list' to list available profiles. -a, --artifacts ARTIFACTS Specify the artifacts to be collected during the collection. The expression is a comma separated string where each element is an artifact file. Each element can be prepended with an exclamation mark to exclude the artifact. Special characters such as ! and * must be escaped with a backslash. Examples: --artifacts files/logs/\\*,\\!files/logs/var_log.yaml Use '--artifacts list' to list available artifacts. Positional Arguments: DESTINATION Specify the directory the output file will be created in. Collection Arguments: -m, --mount-point MOUNT_POINT Specify the mount point (default: /). -s, --operating-system OPERATING_SYSTEM Specify the operating system. Options: aix, android, freebsd, linux, macos, netbsd netscaler, openbsd, solaris -u, --run-as-non-root Disable root user check. Note that data collection may be limited. --temp-dir PATH Write all temporary data to this directory. Filter Arguments: --date-range-start YYYY-MM-DD Only collects files that were last modified/accessed/changed after given date. --date-range-end YYYY-MM-DD Only collects files that were last modified/accessed/changed before given date. Informational Arguments: --case-number CASE_NUMBER Specify the case number. --description DESCRIPTION Specify the description. --evidence-number EVIDENCE_NUMBER Specify the evidence number. --examiner EXAMINER Specify the examiner name. --notes NOTES Specify the notes. --hostname HOSTNAME Specify the target system hostname. Remote Transfer Arguments: --sftp SERVER Transfer output file to remote SFTP server. SERVER must be specified in the form [user@]host:[path] --sftp-port PORT Remote SFTP server port (default: 22). --sftp-identity-file FILE File from which the identity (private key) for public key authentication is read. --sftp-delete-local-on-success Delete local output file on successful transfer. Validation Arguments: --validate-artifacts-file FILE Validate artifacts file.","title":"Command line options"},{"location":"#using-uac","text":"A profile name or a list of artifacts , and the destination directory need to be provided in order to run a collection. The remaining parameters are optional. Common usage scenarios may include the following: Collect all artifacts based on the full profile, and create the output file in /tmp . ./uac -p full /tmp Collect all live_response , and the bodyfile/bodyfile.yaml artifact, and create the output file in the current directory. ./uac -a live_response/\\*,bodyfile/bodyfile.yaml . Collect all artifacts based on the full profile, but excludes the bodyfile/bodyfile.yaml artifact, and create the output file in /tmp . ./uac -p full -a \\!bodyfile/bodyfile.yaml /tmp Note that when a profile and a list of artifacts are provided, the artifacts from the profile will always be collected first, even if the parameter -a was provided before -p in the command line. In the example below, the memory_dump/avml.yaml artifact will only be collected after all artifacts from full profile were collected. ./uac -a memory_dump/avml.yaml -p full /tmp Collect all artifacts based on the full profile, but limiting the data collection based on the date range provided. ./uac -p full /tmp --date-range-start 2021-05-01 --date-range-end 2021-08-31 Collect all but live response artifacts from a Linux disk image mounted in /mnt/ewf . ./uac -p full -a \\!live_response/\\* /tmp --mount-point /mnt/ewf --operating-system linux","title":"Using UAC"},{"location":"#validating-custom-artifacts-files","text":"It is recommended that you validate your custom artifacts files before running a collection. You can do it using the --validate-artifacts-file option as shown below. ./uac --validate-artifacts-file ./artifacts/files/my_custom_artifact.yaml","title":"Validating custom artifacts files"},{"location":"#using-your-own-binary-files","text":"Place your validated binary files in the [uac_directory]\\bin directory if you want them to be executed instead of the built-in ones provided by the target operating system. UAC will detect and run CPU architecture specific executable files, so they need to be placed within the following directory structure: [uac_directory]\\bin\\[operating_system]\\[architecture] . Operating system must be one of the following options (in lowercase): android, aix, freebsd, linux, macos, netbsd, netscaler, openbsd or solaris. Architecture is the kernel architecture (in lowercase). It can be retrieved using uname tool. For example: if you have a ss binary for Linux x86_64, it needs to be placed in the [uac_directory]\\bin\\linux\\x86_64 directory. if you have a lsof binary for AIX powerpc, it needs to be placed in the [uac_directory]\\bin\\aix\\powerpc directory. if you have a netstat binary for Android aarch64, it needs to be placed in the [uac_directory]\\bin\\android\\aarch64 directory.","title":"Using your own binary files"},{"location":"#troubleshooting-and-support","text":"","title":"Troubleshooting and support"},{"location":"#debug-mode","text":"Debug mode --debug may be useful if you are trying to find the source for an error. When debug mode is on, UAC will use set -x to generate debugging messages, and store them into uac.log.stderr file.","title":"Debug mode"},{"location":"#file-an-issue-on-github","text":"If you are experiencing an issue with UAC, you can create a New Issue at the project page . See the Github guide on creating an issue for more information.","title":"File an issue on Github"},{"location":"#license","text":"The UAC project uses the Apache License Version 2.0 software license.","title":"License"},{"location":"artifacts_file/","text":"Artifacts file definition Artifacts are used to define parameters that will be used by a collector to collect data. They are YAML files located in the artifacts directory. Artifacts files should always be created for artifacts that can be grouped together. For instance, artifacts related to ps command should be put all in the same file. This makes artifacts collection to be more granular depending on the case you are working on. UAC reads artifacts files on the fly and, based on their contents, collects relevant artifacts using one of the 5 available collectors . The example below contains 2 set of rules, which the first one uses the hash collector, and the second one uses the command collector to collect the artifacts. version: 1.0 artifacts: - description: Hash running processes. supported_os: [aix] collector: hash path: /proc/[0-9]*/object/a.out output_file: hash_running_processes - description: Collect running processes executable path. supported_os: [freebsd, macos, openbsd] collector: command command: ps -eo args | grep ^/ | awk '{print $1}' | sort -u output_file: hash_running_processes_full_paths.txt An artifact file has one required field at the top of the file version , followed by a set of rules artifacts that will be used by one of the collectors to collect the desired data. version Required The artifact file version. It needs to be updated everytime a new artifact is added or changed. artifacts Required Set of rules (sequence of mappings) that defines what artifact will be collected. An artifact rule has three mandatory fields description , supported_os and collector , followed by additional fields depending on the collector chosen. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command ... # additional options depending on the collector - description: Hash files that contain at least +x flag set for owner. supported_os: [all] collector: hash ... # additional options depending on the collector - description: Collect /var/log logs. supported_os: [all] collector: file ... # additional options depending on the collector description Required One line description of what will be collected. No like breaks supported. supported_os Required List of operating systems that the artifact applies to. Use all if the artifact applies to all operating systems. The currently suppored operating systems are (case sensitive): Value Description aix Artifact applies to AIX systems. android Artifact applies to Android systems. freebsd Artifact applies to FreeBSD systems. linux Artifact applies to Linux systems. macos Artifact applies to macOS systems. netbsd Artifact applies to NetBSD systems. netscaler Artifact applies to NetScaler systems. openbsd Artifact applies to OpenBSD systems. solaris Artifact applies to Solaris systems. Examples: Artifact applies to all supported operating systems: artifacts: - description: Artifact description. supported_os: [all] collector: hash ... # additional options depending on the collector Artifact applies to Aix, FreeBSD and Solaris systems only: artifacts: - description: Artifact description. supported_os: [aix, freebsd, solaris] collector: stat ... # additional options depending on the collector collector Required UAC uses collectors to collect artifacts. Each collector is used for a specific function and requires its own options. Please check the collectors page for more details. Value Description command Use this collector to run commands and store the output into an output file. find Use this collector to find files and directories using either find or find.pl tool, and store the output into a text file. hash Use this collector to hash files and store the output into a text file. stat Use this collector to extract information from files and directories using either stat or stat.pl tool to create a body file. file Use this collector to collect files and directories.","title":"Artifacts file"},{"location":"artifacts_file/#artifacts-file-definition","text":"Artifacts are used to define parameters that will be used by a collector to collect data. They are YAML files located in the artifacts directory. Artifacts files should always be created for artifacts that can be grouped together. For instance, artifacts related to ps command should be put all in the same file. This makes artifacts collection to be more granular depending on the case you are working on. UAC reads artifacts files on the fly and, based on their contents, collects relevant artifacts using one of the 5 available collectors . The example below contains 2 set of rules, which the first one uses the hash collector, and the second one uses the command collector to collect the artifacts. version: 1.0 artifacts: - description: Hash running processes. supported_os: [aix] collector: hash path: /proc/[0-9]*/object/a.out output_file: hash_running_processes - description: Collect running processes executable path. supported_os: [freebsd, macos, openbsd] collector: command command: ps -eo args | grep ^/ | awk '{print $1}' | sort -u output_file: hash_running_processes_full_paths.txt An artifact file has one required field at the top of the file version , followed by a set of rules artifacts that will be used by one of the collectors to collect the desired data.","title":"Artifacts file definition"},{"location":"artifacts_file/#version","text":"Required The artifact file version. It needs to be updated everytime a new artifact is added or changed.","title":"version"},{"location":"artifacts_file/#artifacts","text":"Required Set of rules (sequence of mappings) that defines what artifact will be collected. An artifact rule has three mandatory fields description , supported_os and collector , followed by additional fields depending on the collector chosen. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command ... # additional options depending on the collector - description: Hash files that contain at least +x flag set for owner. supported_os: [all] collector: hash ... # additional options depending on the collector - description: Collect /var/log logs. supported_os: [all] collector: file ... # additional options depending on the collector","title":"artifacts"},{"location":"artifacts_file/#description","text":"Required One line description of what will be collected. No like breaks supported.","title":"description"},{"location":"artifacts_file/#supported_os","text":"Required List of operating systems that the artifact applies to. Use all if the artifact applies to all operating systems. The currently suppored operating systems are (case sensitive): Value Description aix Artifact applies to AIX systems. android Artifact applies to Android systems. freebsd Artifact applies to FreeBSD systems. linux Artifact applies to Linux systems. macos Artifact applies to macOS systems. netbsd Artifact applies to NetBSD systems. netscaler Artifact applies to NetScaler systems. openbsd Artifact applies to OpenBSD systems. solaris Artifact applies to Solaris systems. Examples: Artifact applies to all supported operating systems: artifacts: - description: Artifact description. supported_os: [all] collector: hash ... # additional options depending on the collector Artifact applies to Aix, FreeBSD and Solaris systems only: artifacts: - description: Artifact description. supported_os: [aix, freebsd, solaris] collector: stat ... # additional options depending on the collector","title":"supported_os"},{"location":"artifacts_file/#collector","text":"Required UAC uses collectors to collect artifacts. Each collector is used for a specific function and requires its own options. Please check the collectors page for more details. Value Description command Use this collector to run commands and store the output into an output file. find Use this collector to find files and directories using either find or find.pl tool, and store the output into a text file. hash Use this collector to hash files and store the output into a text file. stat Use this collector to extract information from files and directories using either stat or stat.pl tool to create a body file. file Use this collector to collect files and directories.","title":"collector"},{"location":"collectors/","text":"Collectors command collector Use this collector to run commands and store the output into an output file. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps output_file: ps.txt - description: Report a snapshot of the current processes. supported_os: [aix, freebsd, linux, macos, netbsd, openbsd, solaris] collector: command command: ps auxwww output_file: ps_auxwww.txt - description: Extract strings from running processes. supported_os: [aix] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/object/a.out output_directory: proc/%line% output_file: strings.txt compress_output_file: true command Required The command that will be run in the target system and the output will be collected from. The path to the executable is not required. Only the name of the executable and the parameters should be given. UAC can also run executables located in the bin directory. Even in this case the path to the executable is not required. The bin directory is always added to PATH when UAC starts. Please refer to bin/README.md file for more information. The example below shows how to collect the output from ps -ef command: artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps -ef output_file: ps_-ef.txt loop_command Optional The command that will be run and the output lines will be used as the input for the command option. The logic behind it is: for (each line returned by loop_command); do command done There is one variable that can be used that will be replaced by UAC at runtime: VARIABLE NAME DESCRIPTION %line% Replaced with each line returned by the execution of the loop_command command Let's suppose you need to collect containers logs, and you don't know the containers IDs. First you need to retrieve all the IDs: docker container ps -all | sed 1d | awk '{print $1}' The %line% variable will be replaced by each output line resulted from that command (which are containers IDs in the example above). This means if you have 10 containers, the command docker container logs %line% will be run 10 times, one for each container ID. Example: artifacts: - description: Fetch the logs of all containers. supported_os: [linux] collector: command loop_command: docker container ps -all | sed 1d | awk '{print $1}' command: docker container logs %line% output_file: docker_container_logs_%line%.txt output_file Required Output file name where collected data will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. Both ps and ps auxwww outputs will be stored into the same ps.txt file in the example below. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps output_file: ps.txt - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps auxwww output_file: ps.txt output_directory Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true compressed_output_file Optional The output file will be compressed by gzip if this option is set to true . The following artifact will have its output stored into the compressed output file ps_-ef.txt.gz in the example below. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps -ef output_file: ps_-ef.txt compress_output_file: true exclude_nologin_users Optional Use this option to search artifacts from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Run 'ls -lRa' on all home directories for users that have a valid shell only. supported_os: [all] collector: command command: ls -lRa /%user_home%/ exclude_nologin_users: true output_file: ls_-lRa_%user%.txt find collector Use this collector to find files and directories using either find or find.pl tool, and store the output into a text file. artifacts: - description: Find files that contain at least +x flag set for other. supported_os: [all] collector: find path: / exclude_file_system: [proc, procfs] file_type: f max_depth: 4 max_file_size: 3072000 permissions: -001 output_file: list_of_executable_files.txt path Required The starting point from where the artifact will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every artifact should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Search all cmdline files within /proc/*/ supported_os: [all] collector: find path: /proc/*/cmdline output_file: cmdline.txt For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Search all files and directories within /etc . Note the use of a * at the end of the path. artifacts: - description: Search all files and directories within /etc. supported_os: [all] collector: find path: /etc/* output_file: etc.txt Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Search for TCC.db file. supported_os: [all] collector: find path: /Library/\"Application Support\"/com.apple.TCC/TCC.db output_file: path_with_spaces.txt path_pattern Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: find path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] output_file: discord_cache.txt name_pattern Optional Return the full file path if one of the name_pattern values matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Search all wtmp and utmp files. supported_os: [all] collector: find path: /var/* name_pattern: [\"wtmp\", \"btmp\"] output_file: wtmp_btmp.txt As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Search all HTML and TXT files. supported_os: [all] collector: find path: /* name_pattern: [\"*.html\", \"*.txt\"] output_file: all_html_txt.txt artifacts: - description: Search all .log and .Log (capital L) files. supported_os: [all] collector: find path: /var/log/* name_pattern: [\"*.[Ll]og\"] output_file: all_log_files.txt exclude_path_pattern Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Search all excluding /etc and /var. supported_os: [all] collector: find path: /* exclude_path_pattern: [\"/dev\", \"/var\"] output_file: all_excluding_etc_var.txt exclude_name_pattern Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Search /etc excluding passwd and shadow* files. supported_os: [all] collector: find path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] output_file: etc_excluding_passwd_shadow.txt exclude_file_system Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Search all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: find path: /* exclude_file_system: [procfs, nfs, devfs] output_file: exclude_procfs_nfs_devfs.txt max_depth Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: find path: /* max_depth: 5 output_file: max_5_levels.txt file_type Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Search files only. supported_os: [all] collector: find path: /* file_type: f output_file: files_only.txt artifacts: - description: Search directories only. supported_os: [all] collector: find path: /* file_type: d output_file: directories_only.txt min_file_size Optional The minimum size of a file to search, in bytes. Any files smaller than this will be ignored. artifacts: - description: Search all files bigger than 1048576 bytes. supported_os: [all] collector: find path: /* file_type: f min_file_size: 1048576 output_file: bigger_than.txt max_file_size Optional The maximum size of a file to search, in bytes. Any files bigger than this will be ignored. artifacts: - description: Search all files smaller than 1048576 bytes. supported_os: [all] collector: find path: /* file_type: f max_file_size: 1048576 output_file: smaller_than.txt permissions Optional Use this option to search for files and directories based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Search files that have permissions set to 755. supported_os: [all] collector: find path: /* file_type: f permissions: 755 output_file: all_755_permissions.txt All of the permission bits mode (octal) are set for the file. artifacts: - description: Search for files that have SUID bit set. supported_os: [all] collector: find path: /* file_type: f permissions: -4000 output_file: suid_files.txt ignore_date_range Optional Use this option to collect files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to collect some files regardless their last accessed, modified and changed dates. Example, search for all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Search /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: find path: /etc/* ignore_date_range: true output_file: ignore_date_range.txt exclude_nologin_users Optional Use this option to search artifacts from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Collect .bash_history file from users that have a valid shell only. supported_os: [all] collector: find path: /%user_home%/.bash_history exclude_nologin_users: true output_file: exclude_nologin_users.txt output_file Required Output file name where the list of files will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. artifacts: - description: Search all files and directories from /etc. supported_os: [all] collector: find path: /etc/* output_file: same_output_file.txt - description: Search all files and directories from /var/log. supported_os: [all] collector: find path: /var/log/* output_file: same_output_file.txt output_directory Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true hash collector Use this collector to hash files and store the output into a text file. Hash algorithms that will be used during collection are defined in config/uac.conf file. artifacts: - description: Hash all files smaller than 3072000 bytes. supported_os: [all] collector: hash path: /* exclude_file_system: [proc, procfs] file_type: f max_depth: 4 max_file_size: 3072000 output_file: hash.txt path Required The starting point from where the files will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every file should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Hash /bin/sh file. supported_os: [all] collector: hash path: /bin/sh output_file: hash_bin_sh.txt For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Hash all files within /etc . Note the use of a * at the end of the path. artifacts: - description: Hash all files and directories within /etc. supported_os: [all] collector: hash path: /etc/* output_file: hashes_etc.txt Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Hash TCC.db file. supported_os: [all] collector: hash path: /Library/\"Application Support\"/com.apple.TCC/TCC.db output_file: path_with_spaces.txt is_file_list Optional If set to true, the path option will refer to a file list containing one path per line. This is useful when you need to hash files based on a file list. artifacts: - description: Hash files based on a file list located in /%uac_directory%/my_file_list.txt. supported_os: [all] collector: hash path: /%uac_directory%/my_file_list.txt is_file_list: true output_file: hash_my_file_list.txt path_pattern Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: hash path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] output_file: discord_cache name_pattern Optional Return the full file path if one of the values of name_pattern matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Hash all wtmp and utmp files. supported_os: [all] collector: hash path: /var/* name_pattern: [\"wtmp\", \"btmp\"] output_file: hash_wtmp_btmp.txt As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Hash all HTML and TXT files. supported_os: [all] collector: hash path: /* name_pattern: [\"*.html\", \"*.txt\"] output_file: hash_all_html_txt artifacts: - description: Hash all .log and .Log (capital L) files. supported_os: [all] collector: hash path: /var/log/* name_pattern: [\"*.[Ll]og\"] output_file: hash_all_log_files exclude_path_pattern Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Hash all files excluding /etc and /var. supported_os: [all] collector: hash path: /* exclude_path_pattern: [\"/dev\", \"/var\"] output_file: all_excluding_etc_var.txt exclude_name_pattern Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Hash all from /etc excluding passwd and shadow* files. supported_os: [all] collector: hash path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] output_file: hash_etc_excluding_passwd_shadow.txt exclude_file_system Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Hash all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: hash path: /* exclude_file_system: [procfs, nfs, devfs] file_type: f output_file: hash_all_exclude_procfs_nfs_devfs.txt max_depth Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: hash path: /* max_depth: 5 output_file: hash_max_5_levels.txt file_type Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Hash files only supported_os: [all] collector: find path: /* file_type: f output_file: files_only.txt min_file_size Optional The minimum size of a file to hash, in bytes. Any files smaller than this will be ignored. artifacts: - description: Hash all files bigger than 1048576 bytes supported_os: [all] collector: hash path: /* file_type: f min_file_size: 1048576 output_file: hash_bigger_than.txt max_file_size Optional The maximum size of a file to hash, in bytes. Any files bigger than this will be ignored. artifacts: - description: Hash all files smaller than 1048576 bytes supported_os: [all] collector: hash path: /* file_type: f max_file_size: 1048576 output_file: hash_smaller_than.txt permissions Optional Use this option to hash files based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Hash files that have permissions set to 755. supported_os: [all] collector: hash path: /* file_type: f permissions: 755 output_file: hash_all_755_permissions.txt All of the permission bits mode (octal) are set for the file. artifacts: - description: Hash all files that have SUID bit set. supported_os: [all] collector: hash path: /* file_type: f permissions: -4000 output_file: hash_suid_files.txt ignore_date_range Optional Use this option to hash files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to hash some files regardless their last accessed, modified and changed dates. Example, hash for all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Hash all files from /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: hash path: /etc/* ignore_date_range: true output_file: hash_ignore_date_range.txt exclude_nologin_users Optional Use this option to hash files from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Hash .bash_history file from users that have a valid shell only. supported_os: [all] collector: hash path: /%user_home%/.bash_history exclude_nologin_users: true output_file: hash_exclude_nologin_users.txt output_file Required Output file name where the hashes will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. The proper file extension (.md5, .sha1 or .sha256) will be added automatically to the output file according to the hash algorithm used to hash the files. In the example below, the output file will be same_output_file.txt.md5 and same_output_file.txt.sha256 if MD5 and SHA256 algorithms were set in config/uac.conf file. artifacts: - description: Hash all files and directories from /etc. supported_os: [all] collector: hash path: /etc/* output_file: same_output_file.txt - description: Hash all files and directories from /var/log. supported_os: [all] collector: hash path: /var/log/* output_file: same_output_file.txt output_directory Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true stat collector Use this collector to extract information from files and directories using either stat or stat.pl tool to create a body file. The body file is an intermediate file when creating a timeline of file activity. It is a pipe (\"|\") delimited text file that contains one line for each file. Plaso and mactime tools can be used to read this file and sorts the contents. artifacts: - description: Stat all files. supported_os: [all] collector: stat path: /* file_type: f output_file: stat.txt path Required The starting point from where the files will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every file should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Stat /bin/sh file. supported_os: [all] collector: stat path: /bin/sh output_file: stat_bin_sh.txt For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Stat all files within /etc . Note the use of a * at the end of the path. artifacts: - description: Stat all files and directories within /etc. supported_os: [all] collector: stat path: /etc/* output_file: stat_etc.txt Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Stat TCC.db file. supported_os: [all] collector: stat path: /Library/\"Application Support\"/com.apple.TCC/TCC.db output_file: path_with_spaces.txt is_file_list Optional If set to true, the path option will refer to a file list containing one path per line. This is useful when you need to stat files based on a file list. artifacts: - description: Stat files based on a file list located in /%uac_directory%/my_file_list.txt. supported_os: [all] collector: stat path: /%uac_directory%/my_file_list.txt is_file_list: true output_file: stat_my_file_list.txt path_pattern Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: stat path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] output_file: discord_cache.txt name_pattern Optional Return the full file path if one of the values of name_pattern matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Stat all wtmp and utmp files. supported_os: [all] collector: stat path: /var/* name_pattern: [\"wtmp\", \"btmp\"] output_file: stat_wtmp_btmp.txt As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Stat all HTML and TXT files. supported_os: [all] collector: stat path: /* name_pattern: [\"*.html\", \"*.txt\"] output_file: stat_all_html_txt artifacts: - description: Stat all .log and .Log (capital L) files. supported_os: [all] collector: stat path: /var/log/* name_pattern: [\"*.[Ll]og\"] output_file: stat_all_log_files exclude_path_pattern Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Stat all files excluding /etc and /var. supported_os: [all] collector: stat path: /* exclude_path_pattern: [\"/dev\", \"/var\"] output_file: stat_all_excluding_etc_var.txt exclude_name_pattern Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Stat all from /etc excluding passwd and shadow* files. supported_os: [all] collector: stat path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] output_file: stat_etc_excluding_passwd_shadow.txt exclude_file_system Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Stat all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: stat path: /* exclude_file_system: [procfs, nfs, devfs] file_type: f output_file: stat_all_exclude_procfs_nfs_devfs.txt max_depth Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: stat path: /* max_depth: 5 output_file: stat_max_5_levels.txt file_type Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Stat files only. supported_os: [all] collector: stat path: /* file_type: f output_file: stat_files_only.txt artifacts: - description: Stat directories only. supported_os: [all] collector: stat path: /* file_type: d output_file: stat_directories_only.txt min_file_size Optional The minimum size of a file to stat, in bytes. Any files smaller than this will be ignored. artifacts: - description: Stat all files bigger than 1048576 bytes. supported_os: [all] collector: stat path: /* file_type: f min_file_size: 1048576 output_file: stat_bigger_than.txt max_file_size Optional The maximum size of a file to stat, in bytes. Any files bigger than this will be ignored. artifacts: - description: Stat all files smaller than 1048576 bytes. supported_os: [all] collector: stat path: /* file_type: f max_file_size: 1048576 output_file: stat_smaller_than.txt permissions Optional Use this option to stat files based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Stat files that have permissions set to 755. supported_os: [all] collector: stat path: /* file_type: f permissions: 755 output_file: stat_all_755_permissions.txt All of the permission bits mode (octal) are set for the file. artifacts: - description: Stat all files that have SUID bit set. supported_os: [all] collector: stat path: /* file_type: f permissions: -4000 output_file: stat_suid_files.txt ignore_date_range Optional Use this option to stat files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to stat some files regardless their last accessed, modified and changed dates. Example, stat for all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Stat all files from /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: stat path: /etc/* ignore_date_range: true output_file: stat_ignore_date_range.txt exclude_nologin_users Optional Use this option to stat files from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Stat .bash_history file from users that have a valid shell only. supported_os: [all] collector: stat path: /%user_home%/.bash_history exclude_nologin_users: true output_file: stat_exclude_nologin_users.txt output_file Required Output file name where the stat information will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. artifacts: - description: Stat all files and directories from /etc. supported_os: [all] collector: stat path: /etc/* output_file: same_output_file.txt - description: Stat all files and directories from /var/log. supported_os: [all] collector: stat path: /var/log/* output_file: same_output_file.txt output_directory Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true file collector Use this collector to collect files and directories. artifacts: - description: Collect all files within /var/log (recursive). supported_os: [all] collector: file path: /var/log/* file_type: f path Required The starting point from where the files will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every file should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Collect /bin/sh file. supported_os: [all] collector: file path: /bin/sh For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Collect all files from /etc . Note the use of a * at the end of the path. artifacts: - description: Collect all files and directories within /etc. supported_os: [all] collector: file path: /etc/* Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Collect TCC.db file. supported_os: [all] collector: file path: /Library/\"Application Support\"/com.apple.TCC/TCC.db is_file_list Optional If set to true, the path option will refer to a file list containing one path per line. This is useful when you need to collect files based on a file list. artifacts: - description: Collect files based on a file list located in /%uac_directory%/my_file_list.txt. supported_os: [all] collector: file path: /%uac_directory%/my_file_list.txt is_file_list: true path_pattern Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: file path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] name_pattern Optional Return the full file path if one of the values of name_pattern matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Collect all wtmp and utmp files. supported_os: [all] collector: file path: /var/* name_pattern: [\"wtmp\", \"btmp\"] As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Collect all HTML and TXT files. supported_os: [all] collector: file path: /* name_pattern: [\"*.html\", \"*.txt\"] artifacts: - description: Collect all .log and .Log (capital L) files. supported_os: [all] collector: file path: /var/log/* name_pattern: [\"*.[Ll]og\"] exclude_path_pattern Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Collect all files excluding /etc and /var. supported_os: [all] collector: file path: /* exclude_path_pattern: [\"/dev\", \"/var\"] exclude_name_pattern Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Collect all from /etc excluding passwd and shadow* files. supported_os: [all] collector: file path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] exclude_file_system Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Collect all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: file path: /* exclude_file_system: [procfs, nfs, devfs] file_type: f max_depth Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: file path: /* max_depth: 5 file_type Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Collect files only. supported_os: [all] collector: file path: /var/log/* file_type: f min_file_size Optional The minimum size of a file to stat, in bytes. Any files smaller than this will be ignored. artifacts: - description: Collect all files bigger than 1048576 bytes. supported_os: [all] collector: file path: /* file_type: f min_file_size: 1048576 max_file_size Optional The maximum size of a file to stat, in bytes. Any files bigger than this will be ignored. artifacts: - description: Collect all files smaller than 1048576 bytes. supported_os: [all] collector: file path: /* file_type: f max_file_size: 1048576 permissions Optional Use this option to collect files based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Collect files that have permissions set to 755. supported_os: [all] collector: file path: /* file_type: f permissions: 755 All of the permission bits mode (octal) are set for the file. artifacts: - description: Collect all files that have SUID bit set. supported_os: [all] collector: file path: /* file_type: f permissions: -4000 ignore_date_range Optional Use this option to collect files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to collect some files regardless their last accessed, modified and changed dates. Example, collect all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Collect all files from /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: file path: /etc/* ignore_date_range: true exclude_nologin_users Optional Use this option to collect files from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Collect .bash_history file from users that have a valid shell only. supported_os: [all] collector: file path: /%user_home%/.bash_history exclude_nologin_users: true","title":"Collectors"},{"location":"collectors/#collectors","text":"","title":"Collectors"},{"location":"collectors/#command-collector","text":"Use this collector to run commands and store the output into an output file. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps output_file: ps.txt - description: Report a snapshot of the current processes. supported_os: [aix, freebsd, linux, macos, netbsd, openbsd, solaris] collector: command command: ps auxwww output_file: ps_auxwww.txt - description: Extract strings from running processes. supported_os: [aix] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/object/a.out output_directory: proc/%line% output_file: strings.txt compress_output_file: true","title":"command collector"},{"location":"collectors/#command","text":"Required The command that will be run in the target system and the output will be collected from. The path to the executable is not required. Only the name of the executable and the parameters should be given. UAC can also run executables located in the bin directory. Even in this case the path to the executable is not required. The bin directory is always added to PATH when UAC starts. Please refer to bin/README.md file for more information. The example below shows how to collect the output from ps -ef command: artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps -ef output_file: ps_-ef.txt","title":"command"},{"location":"collectors/#loop_command","text":"Optional The command that will be run and the output lines will be used as the input for the command option. The logic behind it is: for (each line returned by loop_command); do command done There is one variable that can be used that will be replaced by UAC at runtime: VARIABLE NAME DESCRIPTION %line% Replaced with each line returned by the execution of the loop_command command Let's suppose you need to collect containers logs, and you don't know the containers IDs. First you need to retrieve all the IDs: docker container ps -all | sed 1d | awk '{print $1}' The %line% variable will be replaced by each output line resulted from that command (which are containers IDs in the example above). This means if you have 10 containers, the command docker container logs %line% will be run 10 times, one for each container ID. Example: artifacts: - description: Fetch the logs of all containers. supported_os: [linux] collector: command loop_command: docker container ps -all | sed 1d | awk '{print $1}' command: docker container logs %line% output_file: docker_container_logs_%line%.txt","title":"loop_command"},{"location":"collectors/#output_file","text":"Required Output file name where collected data will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. Both ps and ps auxwww outputs will be stored into the same ps.txt file in the example below. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps output_file: ps.txt - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps auxwww output_file: ps.txt","title":"output_file"},{"location":"collectors/#output_directory","text":"Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true","title":"output_directory"},{"location":"collectors/#compressed_output_file","text":"Optional The output file will be compressed by gzip if this option is set to true . The following artifact will have its output stored into the compressed output file ps_-ef.txt.gz in the example below. artifacts: - description: Report a snapshot of the current processes. supported_os: [all] collector: command command: ps -ef output_file: ps_-ef.txt compress_output_file: true","title":"compressed_output_file"},{"location":"collectors/#exclude_nologin_users","text":"Optional Use this option to search artifacts from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Run 'ls -lRa' on all home directories for users that have a valid shell only. supported_os: [all] collector: command command: ls -lRa /%user_home%/ exclude_nologin_users: true output_file: ls_-lRa_%user%.txt","title":"exclude_nologin_users"},{"location":"collectors/#find-collector","text":"Use this collector to find files and directories using either find or find.pl tool, and store the output into a text file. artifacts: - description: Find files that contain at least +x flag set for other. supported_os: [all] collector: find path: / exclude_file_system: [proc, procfs] file_type: f max_depth: 4 max_file_size: 3072000 permissions: -001 output_file: list_of_executable_files.txt","title":"find collector"},{"location":"collectors/#path","text":"Required The starting point from where the artifact will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every artifact should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Search all cmdline files within /proc/*/ supported_os: [all] collector: find path: /proc/*/cmdline output_file: cmdline.txt For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Search all files and directories within /etc . Note the use of a * at the end of the path. artifacts: - description: Search all files and directories within /etc. supported_os: [all] collector: find path: /etc/* output_file: etc.txt Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Search for TCC.db file. supported_os: [all] collector: find path: /Library/\"Application Support\"/com.apple.TCC/TCC.db output_file: path_with_spaces.txt","title":"path"},{"location":"collectors/#path_pattern","text":"Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: find path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] output_file: discord_cache.txt","title":"path_pattern"},{"location":"collectors/#name_pattern","text":"Optional Return the full file path if one of the name_pattern values matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Search all wtmp and utmp files. supported_os: [all] collector: find path: /var/* name_pattern: [\"wtmp\", \"btmp\"] output_file: wtmp_btmp.txt As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Search all HTML and TXT files. supported_os: [all] collector: find path: /* name_pattern: [\"*.html\", \"*.txt\"] output_file: all_html_txt.txt artifacts: - description: Search all .log and .Log (capital L) files. supported_os: [all] collector: find path: /var/log/* name_pattern: [\"*.[Ll]og\"] output_file: all_log_files.txt","title":"name_pattern"},{"location":"collectors/#exclude_path_pattern","text":"Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Search all excluding /etc and /var. supported_os: [all] collector: find path: /* exclude_path_pattern: [\"/dev\", \"/var\"] output_file: all_excluding_etc_var.txt","title":"exclude_path_pattern"},{"location":"collectors/#exclude_name_pattern","text":"Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Search /etc excluding passwd and shadow* files. supported_os: [all] collector: find path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] output_file: etc_excluding_passwd_shadow.txt","title":"exclude_name_pattern"},{"location":"collectors/#exclude_file_system","text":"Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Search all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: find path: /* exclude_file_system: [procfs, nfs, devfs] output_file: exclude_procfs_nfs_devfs.txt","title":"exclude_file_system"},{"location":"collectors/#max_depth","text":"Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: find path: /* max_depth: 5 output_file: max_5_levels.txt","title":"max_depth"},{"location":"collectors/#file_type","text":"Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Search files only. supported_os: [all] collector: find path: /* file_type: f output_file: files_only.txt artifacts: - description: Search directories only. supported_os: [all] collector: find path: /* file_type: d output_file: directories_only.txt","title":"file_type"},{"location":"collectors/#min_file_size","text":"Optional The minimum size of a file to search, in bytes. Any files smaller than this will be ignored. artifacts: - description: Search all files bigger than 1048576 bytes. supported_os: [all] collector: find path: /* file_type: f min_file_size: 1048576 output_file: bigger_than.txt","title":"min_file_size"},{"location":"collectors/#max_file_size","text":"Optional The maximum size of a file to search, in bytes. Any files bigger than this will be ignored. artifacts: - description: Search all files smaller than 1048576 bytes. supported_os: [all] collector: find path: /* file_type: f max_file_size: 1048576 output_file: smaller_than.txt","title":"max_file_size"},{"location":"collectors/#permissions","text":"Optional Use this option to search for files and directories based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Search files that have permissions set to 755. supported_os: [all] collector: find path: /* file_type: f permissions: 755 output_file: all_755_permissions.txt All of the permission bits mode (octal) are set for the file. artifacts: - description: Search for files that have SUID bit set. supported_os: [all] collector: find path: /* file_type: f permissions: -4000 output_file: suid_files.txt","title":"permissions"},{"location":"collectors/#ignore_date_range","text":"Optional Use this option to collect files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to collect some files regardless their last accessed, modified and changed dates. Example, search for all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Search /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: find path: /etc/* ignore_date_range: true output_file: ignore_date_range.txt","title":"ignore_date_range"},{"location":"collectors/#exclude_nologin_users_1","text":"Optional Use this option to search artifacts from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Collect .bash_history file from users that have a valid shell only. supported_os: [all] collector: find path: /%user_home%/.bash_history exclude_nologin_users: true output_file: exclude_nologin_users.txt","title":"exclude_nologin_users"},{"location":"collectors/#output_file_1","text":"Required Output file name where the list of files will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. artifacts: - description: Search all files and directories from /etc. supported_os: [all] collector: find path: /etc/* output_file: same_output_file.txt - description: Search all files and directories from /var/log. supported_os: [all] collector: find path: /var/log/* output_file: same_output_file.txt","title":"output_file"},{"location":"collectors/#output_directory_1","text":"Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true","title":"output_directory"},{"location":"collectors/#hash-collector","text":"Use this collector to hash files and store the output into a text file. Hash algorithms that will be used during collection are defined in config/uac.conf file. artifacts: - description: Hash all files smaller than 3072000 bytes. supported_os: [all] collector: hash path: /* exclude_file_system: [proc, procfs] file_type: f max_depth: 4 max_file_size: 3072000 output_file: hash.txt","title":"hash collector"},{"location":"collectors/#path_1","text":"Required The starting point from where the files will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every file should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Hash /bin/sh file. supported_os: [all] collector: hash path: /bin/sh output_file: hash_bin_sh.txt For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Hash all files within /etc . Note the use of a * at the end of the path. artifacts: - description: Hash all files and directories within /etc. supported_os: [all] collector: hash path: /etc/* output_file: hashes_etc.txt Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Hash TCC.db file. supported_os: [all] collector: hash path: /Library/\"Application Support\"/com.apple.TCC/TCC.db output_file: path_with_spaces.txt","title":"path"},{"location":"collectors/#is_file_list","text":"Optional If set to true, the path option will refer to a file list containing one path per line. This is useful when you need to hash files based on a file list. artifacts: - description: Hash files based on a file list located in /%uac_directory%/my_file_list.txt. supported_os: [all] collector: hash path: /%uac_directory%/my_file_list.txt is_file_list: true output_file: hash_my_file_list.txt","title":"is_file_list"},{"location":"collectors/#path_pattern_1","text":"Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: hash path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] output_file: discord_cache","title":"path_pattern"},{"location":"collectors/#name_pattern_1","text":"Optional Return the full file path if one of the values of name_pattern matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Hash all wtmp and utmp files. supported_os: [all] collector: hash path: /var/* name_pattern: [\"wtmp\", \"btmp\"] output_file: hash_wtmp_btmp.txt As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Hash all HTML and TXT files. supported_os: [all] collector: hash path: /* name_pattern: [\"*.html\", \"*.txt\"] output_file: hash_all_html_txt artifacts: - description: Hash all .log and .Log (capital L) files. supported_os: [all] collector: hash path: /var/log/* name_pattern: [\"*.[Ll]og\"] output_file: hash_all_log_files","title":"name_pattern"},{"location":"collectors/#exclude_path_pattern_1","text":"Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Hash all files excluding /etc and /var. supported_os: [all] collector: hash path: /* exclude_path_pattern: [\"/dev\", \"/var\"] output_file: all_excluding_etc_var.txt","title":"exclude_path_pattern"},{"location":"collectors/#exclude_name_pattern_1","text":"Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Hash all from /etc excluding passwd and shadow* files. supported_os: [all] collector: hash path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] output_file: hash_etc_excluding_passwd_shadow.txt","title":"exclude_name_pattern"},{"location":"collectors/#exclude_file_system_1","text":"Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Hash all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: hash path: /* exclude_file_system: [procfs, nfs, devfs] file_type: f output_file: hash_all_exclude_procfs_nfs_devfs.txt","title":"exclude_file_system"},{"location":"collectors/#max_depth_1","text":"Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: hash path: /* max_depth: 5 output_file: hash_max_5_levels.txt","title":"max_depth"},{"location":"collectors/#file_type_1","text":"Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Hash files only supported_os: [all] collector: find path: /* file_type: f output_file: files_only.txt","title":"file_type"},{"location":"collectors/#min_file_size_1","text":"Optional The minimum size of a file to hash, in bytes. Any files smaller than this will be ignored. artifacts: - description: Hash all files bigger than 1048576 bytes supported_os: [all] collector: hash path: /* file_type: f min_file_size: 1048576 output_file: hash_bigger_than.txt","title":"min_file_size"},{"location":"collectors/#max_file_size_1","text":"Optional The maximum size of a file to hash, in bytes. Any files bigger than this will be ignored. artifacts: - description: Hash all files smaller than 1048576 bytes supported_os: [all] collector: hash path: /* file_type: f max_file_size: 1048576 output_file: hash_smaller_than.txt","title":"max_file_size"},{"location":"collectors/#permissions_1","text":"Optional Use this option to hash files based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Hash files that have permissions set to 755. supported_os: [all] collector: hash path: /* file_type: f permissions: 755 output_file: hash_all_755_permissions.txt All of the permission bits mode (octal) are set for the file. artifacts: - description: Hash all files that have SUID bit set. supported_os: [all] collector: hash path: /* file_type: f permissions: -4000 output_file: hash_suid_files.txt","title":"permissions"},{"location":"collectors/#ignore_date_range_1","text":"Optional Use this option to hash files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to hash some files regardless their last accessed, modified and changed dates. Example, hash for all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Hash all files from /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: hash path: /etc/* ignore_date_range: true output_file: hash_ignore_date_range.txt","title":"ignore_date_range"},{"location":"collectors/#exclude_nologin_users_2","text":"Optional Use this option to hash files from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Hash .bash_history file from users that have a valid shell only. supported_os: [all] collector: hash path: /%user_home%/.bash_history exclude_nologin_users: true output_file: hash_exclude_nologin_users.txt","title":"exclude_nologin_users"},{"location":"collectors/#output_file_2","text":"Required Output file name where the hashes will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. The proper file extension (.md5, .sha1 or .sha256) will be added automatically to the output file according to the hash algorithm used to hash the files. In the example below, the output file will be same_output_file.txt.md5 and same_output_file.txt.sha256 if MD5 and SHA256 algorithms were set in config/uac.conf file. artifacts: - description: Hash all files and directories from /etc. supported_os: [all] collector: hash path: /etc/* output_file: same_output_file.txt - description: Hash all files and directories from /var/log. supported_os: [all] collector: hash path: /var/log/* output_file: same_output_file.txt","title":"output_file"},{"location":"collectors/#output_directory_2","text":"Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true","title":"output_directory"},{"location":"collectors/#stat-collector","text":"Use this collector to extract information from files and directories using either stat or stat.pl tool to create a body file. The body file is an intermediate file when creating a timeline of file activity. It is a pipe (\"|\") delimited text file that contains one line for each file. Plaso and mactime tools can be used to read this file and sorts the contents. artifacts: - description: Stat all files. supported_os: [all] collector: stat path: /* file_type: f output_file: stat.txt","title":"stat collector"},{"location":"collectors/#path_2","text":"Required The starting point from where the files will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every file should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Stat /bin/sh file. supported_os: [all] collector: stat path: /bin/sh output_file: stat_bin_sh.txt For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Stat all files within /etc . Note the use of a * at the end of the path. artifacts: - description: Stat all files and directories within /etc. supported_os: [all] collector: stat path: /etc/* output_file: stat_etc.txt Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Stat TCC.db file. supported_os: [all] collector: stat path: /Library/\"Application Support\"/com.apple.TCC/TCC.db output_file: path_with_spaces.txt","title":"path"},{"location":"collectors/#is_file_list_1","text":"Optional If set to true, the path option will refer to a file list containing one path per line. This is useful when you need to stat files based on a file list. artifacts: - description: Stat files based on a file list located in /%uac_directory%/my_file_list.txt. supported_os: [all] collector: stat path: /%uac_directory%/my_file_list.txt is_file_list: true output_file: stat_my_file_list.txt","title":"is_file_list"},{"location":"collectors/#path_pattern_2","text":"Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: stat path: /%user_home% path_pattern: [\"*/discord/Cache/*\"] output_file: discord_cache.txt","title":"path_pattern"},{"location":"collectors/#name_pattern_2","text":"Optional Return the full file path if one of the values of name_pattern matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Stat all wtmp and utmp files. supported_os: [all] collector: stat path: /var/* name_pattern: [\"wtmp\", \"btmp\"] output_file: stat_wtmp_btmp.txt As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Stat all HTML and TXT files. supported_os: [all] collector: stat path: /* name_pattern: [\"*.html\", \"*.txt\"] output_file: stat_all_html_txt artifacts: - description: Stat all .log and .Log (capital L) files. supported_os: [all] collector: stat path: /var/log/* name_pattern: [\"*.[Ll]og\"] output_file: stat_all_log_files","title":"name_pattern"},{"location":"collectors/#exclude_path_pattern_2","text":"Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Stat all files excluding /etc and /var. supported_os: [all] collector: stat path: /* exclude_path_pattern: [\"/dev\", \"/var\"] output_file: stat_all_excluding_etc_var.txt","title":"exclude_path_pattern"},{"location":"collectors/#exclude_name_pattern_2","text":"Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Stat all from /etc excluding passwd and shadow* files. supported_os: [all] collector: stat path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"] output_file: stat_etc_excluding_passwd_shadow.txt","title":"exclude_name_pattern"},{"location":"collectors/#exclude_file_system_2","text":"Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Stat all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: stat path: /* exclude_file_system: [procfs, nfs, devfs] file_type: f output_file: stat_all_exclude_procfs_nfs_devfs.txt","title":"exclude_file_system"},{"location":"collectors/#max_depth_2","text":"Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: stat path: /* max_depth: 5 output_file: stat_max_5_levels.txt","title":"max_depth"},{"location":"collectors/#file_type_2","text":"Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Stat files only. supported_os: [all] collector: stat path: /* file_type: f output_file: stat_files_only.txt artifacts: - description: Stat directories only. supported_os: [all] collector: stat path: /* file_type: d output_file: stat_directories_only.txt","title":"file_type"},{"location":"collectors/#min_file_size_2","text":"Optional The minimum size of a file to stat, in bytes. Any files smaller than this will be ignored. artifacts: - description: Stat all files bigger than 1048576 bytes. supported_os: [all] collector: stat path: /* file_type: f min_file_size: 1048576 output_file: stat_bigger_than.txt","title":"min_file_size"},{"location":"collectors/#max_file_size_2","text":"Optional The maximum size of a file to stat, in bytes. Any files bigger than this will be ignored. artifacts: - description: Stat all files smaller than 1048576 bytes. supported_os: [all] collector: stat path: /* file_type: f max_file_size: 1048576 output_file: stat_smaller_than.txt","title":"max_file_size"},{"location":"collectors/#permissions_2","text":"Optional Use this option to stat files based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Stat files that have permissions set to 755. supported_os: [all] collector: stat path: /* file_type: f permissions: 755 output_file: stat_all_755_permissions.txt All of the permission bits mode (octal) are set for the file. artifacts: - description: Stat all files that have SUID bit set. supported_os: [all] collector: stat path: /* file_type: f permissions: -4000 output_file: stat_suid_files.txt","title":"permissions"},{"location":"collectors/#ignore_date_range_2","text":"Optional Use this option to stat files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to stat some files regardless their last accessed, modified and changed dates. Example, stat for all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Stat all files from /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: stat path: /etc/* ignore_date_range: true output_file: stat_ignore_date_range.txt","title":"ignore_date_range"},{"location":"collectors/#exclude_nologin_users_3","text":"Optional Use this option to stat files from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Stat .bash_history file from users that have a valid shell only. supported_os: [all] collector: stat path: /%user_home%/.bash_history exclude_nologin_users: true output_file: stat_exclude_nologin_users.txt","title":"exclude_nologin_users"},{"location":"collectors/#output_file_3","text":"Required Output file name where the stat information will be stored in. UAC never overwrites output files. Data will be appended to file if the same file name is set for a different artifact rule within the same artifact directory. artifacts: - description: Stat all files and directories from /etc. supported_os: [all] collector: stat path: /etc/* output_file: same_output_file.txt - description: Stat all files and directories from /var/log. supported_os: [all] collector: stat path: /var/log/* output_file: same_output_file.txt","title":"output_file"},{"location":"collectors/#output_directory_3","text":"Optional Defines the subdirectory name the output file will be stored in. By default, collected artifacts will always be stored into a directory which its path follows the same structure defined in the artifacts directory. In the example below, the output file created by bodyfile.yaml will be stored into bodyfile directory, and the output files created by docker.yaml will be stored into live_response/containers directory. But in some cases it is preferred to have the output file stored into subdirectories. Let's use the live_response/process/string_running_processes.yaml as an example where the output file is stored into live_response/process/proc/%line% subdirectory. artifacts: - description: Extract strings from running processes. supported_os: [android, linux, netbsd] collector: command loop_command: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done command: strings -a /proc/%line%/exe output_directory: proc/%line% output_file: strings.txt compress_output_file: true","title":"output_directory"},{"location":"collectors/#file-collector","text":"Use this collector to collect files and directories. artifacts: - description: Collect all files within /var/log (recursive). supported_os: [all] collector: file path: /var/log/* file_type: f","title":"file collector"},{"location":"collectors/#path_3","text":"Required The starting point from where the files will be searched for. UAC will recurse into subdirectories unless otherwise prevented by max_depth option. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. Every file should be treated like it originates on the / (root) mount point. The root mount point will be replaced by UAC if a new mount point is set with --mount-point command line option. artifacts: - description: Collect /bin/sh file. supported_os: [all] collector: file path: /bin/sh For keeping consistences across all supported operating systems (and different find tool versions), it is recommended that all directory names ends with a /* (slash asterisks). Collect all files from /etc . Note the use of a * at the end of the path. artifacts: - description: Collect all files and directories within /etc. supported_os: [all] collector: file path: /etc/* Note that you need to use quotation marks when specifying paths with spaces. artifacts: - description: Collect TCC.db file. supported_os: [all] collector: file path: /Library/\"Application Support\"/com.apple.TCC/TCC.db","title":"path"},{"location":"collectors/#is_file_list_2","text":"Optional If set to true, the path option will refer to a file list containing one path per line. This is useful when you need to collect files based on a file list. artifacts: - description: Collect files based on a file list located in /%uac_directory%/my_file_list.txt. supported_os: [all] collector: file path: /%uac_directory%/my_file_list.txt is_file_list: true","title":"is_file_list"},{"location":"collectors/#path_pattern_3","text":"Optional Return the full file path if one of path_pattern values matches the file path. This option works exactly the same way as find's -path option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. The example below searches for Discord's Cache directory anywhere within the user's home directory. Hits would be as follows: /home/user/.config /discord/Cache/ 00bcecbd2455cb22_0 /home/user/.var/app/com.discordapp.Discord/config /discord/Cache/ index /home/user/snap/discord/current/.config /discord/Cache/ ac0fa118bdaaa62e_0 artifacts: - description: Find Discord cache files. supported_os: [all] collector: file path: /%user_home% path_pattern: [\"*/discord/Cache/*\"]","title":"path_pattern"},{"location":"collectors/#name_pattern_3","text":"Optional Return the full file path if one of the values of name_pattern matches the file name. This option works exactly the same way as find's -name option. Because the leading directories are removed, the file names considered for a match with name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. artifacts: - description: Collect all wtmp and utmp files. supported_os: [all] collector: file path: /var/* name_pattern: [\"wtmp\", \"btmp\"] As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Collect all HTML and TXT files. supported_os: [all] collector: file path: /* name_pattern: [\"*.html\", \"*.txt\"] artifacts: - description: Collect all .log and .Log (capital L) files. supported_os: [all] collector: file path: /var/log/* name_pattern: [\"*.[Ll]og\"]","title":"name_pattern"},{"location":"collectors/#exclude_path_pattern_3","text":"Optional Use this option to exclude paths from the collection. This option works exactly the same way as find's -path -prune option. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Collect all files excluding /etc and /var. supported_os: [all] collector: file path: /* exclude_path_pattern: [\"/dev\", \"/var\"]","title":"exclude_path_pattern"},{"location":"collectors/#exclude_name_pattern_3","text":"Optional Use this option to exclude files from the collection. This option works exactly the same way as find's -name -prune option. Because the leading directories are removed, the file names considered for a match with exclude_name_pattern will never include a slash, so \"a/b\" will never match anything. Don't forget to enclose the pattern in double quotes. Use backslash (\\) to escape double quotes and commas. As UAC uses find tool to search for artifacts, wildcards and regex patterns are also supported here. artifacts: - description: Collect all from /etc excluding passwd and shadow* files. supported_os: [all] collector: file path: /etc/* exclude_name_pattern: [\"passwd\", \"shadow*\"]","title":"exclude_name_pattern"},{"location":"collectors/#exclude_file_system_3","text":"Optional Use this option to exclude file systems from the collection. UAC will retrieve the list of existing mountpoints (paths) and exclude them from the collection. The file system types which are supported depend on the target computer's running kernel. artifacts: - description: Collect all files excluding any files located in procfs, nfs and devfs file systems. supported_os: [all] collector: file path: /* exclude_file_system: [procfs, nfs, devfs] file_type: f","title":"exclude_file_system"},{"location":"collectors/#max_depth_3","text":"Optional Descend at most levels (a non-negative integer) levels of directories below the starting-point. Using 0 means only apply the tests and actions to the starting-points themselves. This option works exactly the same way as find's -maxdepth option. artifacts: - description: Descend at most 5 levels of directories below /. supported_os: [all] collector: file path: /* max_depth: 5","title":"max_depth"},{"location":"collectors/#file_type_3","text":"Optional This option works exactly the same way as find's -type option. File is of type: Value Description f regular file d directory l symbolic link p named pipe (FIFO) s socket b block special c character special artifacts: - description: Collect files only. supported_os: [all] collector: file path: /var/log/* file_type: f","title":"file_type"},{"location":"collectors/#min_file_size_3","text":"Optional The minimum size of a file to stat, in bytes. Any files smaller than this will be ignored. artifacts: - description: Collect all files bigger than 1048576 bytes. supported_os: [all] collector: file path: /* file_type: f min_file_size: 1048576","title":"min_file_size"},{"location":"collectors/#max_file_size_3","text":"Optional The maximum size of a file to stat, in bytes. Any files bigger than this will be ignored. artifacts: - description: Collect all files smaller than 1048576 bytes. supported_os: [all] collector: file path: /* file_type: f max_file_size: 1048576","title":"max_file_size"},{"location":"collectors/#permissions_3","text":"Optional Use this option to collect files based on their permissions. This option works exactly the same way as find's -perm option. Please note that symbolic mode is not supported (e.g: -g=w). Permissions can be used as follows: File's permission bits are exactly mode (octal). artifacts: - description: Collect files that have permissions set to 755. supported_os: [all] collector: file path: /* file_type: f permissions: 755 All of the permission bits mode (octal) are set for the file. artifacts: - description: Collect all files that have SUID bit set. supported_os: [all] collector: file path: /* file_type: f permissions: -4000","title":"permissions"},{"location":"collectors/#ignore_date_range_3","text":"Optional Use this option to collect files ignoring the date set using both --date-range-start and --date-range-end command line options. This is useful when you want to set a date range for your collection, but want to collect some files regardless their last accessed, modified and changed dates. Example, collect all files and subdirecties from /etc regardless their last accessed, modified and changed dates, even if a date range was set using --date-range-start and --date-range-end command line options. artifacts: - description: Collect all files from /etc regardless date range set by --date-range-start and --date-range-end. supported_os: [all] collector: file path: /etc/* ignore_date_range: true","title":"ignore_date_range"},{"location":"collectors/#exclude_nologin_users_4","text":"Optional Use this option to collect files from users that have a valid shell only. Any user that has no shell or a shell set as false, halt, nologin, shutdown or sync will be skipped from the collection. artifacts: - description: Collect .bash_history file from users that have a valid shell only. supported_os: [all] collector: file path: /%user_home%/.bash_history exclude_nologin_users: true","title":"exclude_nologin_users"},{"location":"exposed_vars/","text":"Exposed variables There are some variables that can be used that will be replaced by UAC at runtime: Variable Name Description %uac_directory% Replaced with the full path to where uac was run from %output_file% Replaced with the file name set in the output_file option %mount_point% Replaced with the full path of the target mount point %start_date% Replaced with the date specified for --date-range-start %start_date_epoch% Replaced with the epoch converted date specified for --date-range-start %end_date% Replaced with the date specified for --date-range-end %end_date_epoch% Replaced with the epoch converted date specified for --date-range-end The following two variables will trigger a loop which UAC will run the command across all users. Variable Name Description %user% Replaced with the username of each user %user_home% Replaced with the user's home directory path Examples: artifacts: - description: Hash all files based on a file list located in the UAC directory. supported_os: [all] collector: hash path: /%uac_directory%/my_file_list.txt is_file_list: true output_file: my_hash_list.txt artifacts: - description: Capture a RAM dump using AVML tool and store the acquired data into avml.raw file. supported_os: [all] collector: command command: avml %output_file% output_file: avml.raw artifacts: - description: Collect shell history files. supported_os: [all] collector: file path: /%user_home%/ name_pattern: [\".*_history\", \".*history\", \".lesshst\", \".zhistory\"]","title":"Exposed variables"},{"location":"exposed_vars/#exposed-variables","text":"There are some variables that can be used that will be replaced by UAC at runtime: Variable Name Description %uac_directory% Replaced with the full path to where uac was run from %output_file% Replaced with the file name set in the output_file option %mount_point% Replaced with the full path of the target mount point %start_date% Replaced with the date specified for --date-range-start %start_date_epoch% Replaced with the epoch converted date specified for --date-range-start %end_date% Replaced with the date specified for --date-range-end %end_date_epoch% Replaced with the epoch converted date specified for --date-range-end The following two variables will trigger a loop which UAC will run the command across all users. Variable Name Description %user% Replaced with the username of each user %user_home% Replaced with the user's home directory path Examples: artifacts: - description: Hash all files based on a file list located in the UAC directory. supported_os: [all] collector: hash path: /%uac_directory%/my_file_list.txt is_file_list: true output_file: my_hash_list.txt artifacts: - description: Capture a RAM dump using AVML tool and store the acquired data into avml.raw file. supported_os: [all] collector: command command: avml %output_file% output_file: avml.raw artifacts: - description: Collect shell history files. supported_os: [all] collector: file path: /%user_home%/ name_pattern: [\".*_history\", \".*history\", \".lesshst\", \".zhistory\"]","title":"Exposed variables"},{"location":"output_file/","text":"Output file format A compressed archive (tar.gz) file is created in the destination directory when the collection is finished. The following pattern is used for naming output files: uac-HOSTNAME-OPERATING_SYSTEM-YYYYMMDDhhmmss.tar.gz . The compressed archive file is hashed and the value stored into the acquisition log file. Each artifact will be stored into its own directory. Files collected by file collector will be placed into the [root] directory.","title":"Output file format"},{"location":"output_file/#output-file-format","text":"A compressed archive (tar.gz) file is created in the destination directory when the collection is finished. The following pattern is used for naming output files: uac-HOSTNAME-OPERATING_SYSTEM-YYYYMMDDhhmmss.tar.gz . The compressed archive file is hashed and the value stored into the acquisition log file. Each artifact will be stored into its own directory. Files collected by file collector will be placed into the [root] directory.","title":"Output file format"},{"location":"profile_file/","text":"Profile file definition Profiles are used to define the list of artifacts that will be collected during the execution. They are YAML files located in the profiles directory. A profile file has two mandatory fields at the top of the file, followed by a set of artifacts files that will be used during the collection. Example: name: myprofile description: My profile. artifacts: - live_response/process/ps.yaml - live_response/process/lsof.yaml - bodyfile/bodyfile.yaml - hash_executables/hash_executables.yaml name Required The profile name. This is the name UAC uses to find the correct profile file during the script execution. description Required Describes the purpose of the profile as a whole. It should contain all the details about what kind of collection will be performed. No like breaks supported. artifacts Required Set of artifacts files that will be used during the collection. All available artifacts files are located in the artifacts directory. Artifacts files will be executed in the same order they were added to the profile file. The example below shows a profile file which will collect ps , and then lsof artifacts. name: myprofile description: My profile. artifacts: - live_response/process/ps.yaml - live_response/process/lsof.yaml Wildcards and regex patterns (globbing) are also supported to refer to artifacts files. The example below shows a profile which will collect all artifacts located in the live_response/process directory. Note that the artifacts files will be parsed in alphabetical order in this case. name: myprofile description: My profile. artifacts: - live_response/process/* Artifacts files can also be skipped from collection using the exclamation mark (!) before the artifacts file path. The example below shows a profile which will collect all artifacts located in the files directory (and subdirectories), excluding files/logs/additional_logs.yaml and all artifacts files located in files/applications directory. name: myprofile description: My profile. artifacts: - files/* - !files/logs/additional_logs.yaml - !files/applications/*","title":"Profile file"},{"location":"profile_file/#profile-file-definition","text":"Profiles are used to define the list of artifacts that will be collected during the execution. They are YAML files located in the profiles directory. A profile file has two mandatory fields at the top of the file, followed by a set of artifacts files that will be used during the collection. Example: name: myprofile description: My profile. artifacts: - live_response/process/ps.yaml - live_response/process/lsof.yaml - bodyfile/bodyfile.yaml - hash_executables/hash_executables.yaml","title":"Profile file definition"},{"location":"profile_file/#name","text":"Required The profile name. This is the name UAC uses to find the correct profile file during the script execution.","title":"name"},{"location":"profile_file/#description","text":"Required Describes the purpose of the profile as a whole. It should contain all the details about what kind of collection will be performed. No like breaks supported.","title":"description"},{"location":"profile_file/#artifacts","text":"Required Set of artifacts files that will be used during the collection. All available artifacts files are located in the artifacts directory. Artifacts files will be executed in the same order they were added to the profile file. The example below shows a profile file which will collect ps , and then lsof artifacts. name: myprofile description: My profile. artifacts: - live_response/process/ps.yaml - live_response/process/lsof.yaml Wildcards and regex patterns (globbing) are also supported to refer to artifacts files. The example below shows a profile which will collect all artifacts located in the live_response/process directory. Note that the artifacts files will be parsed in alphabetical order in this case. name: myprofile description: My profile. artifacts: - live_response/process/* Artifacts files can also be skipped from collection using the exclamation mark (!) before the artifacts file path. The example below shows a profile which will collect all artifacts located in the files directory (and subdirectories), excluding files/logs/additional_logs.yaml and all artifacts files located in files/applications directory. name: myprofile description: My profile. artifacts: - files/* - !files/logs/additional_logs.yaml - !files/applications/*","title":"artifacts"}]}