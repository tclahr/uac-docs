<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://github.com/tclahr/uac/log_files/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Log Files - UAC Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Log Files";
        var mkdocs_page_input_path = "log_files.md";
        var mkdocs_page_url = "/tclahr/uac/log_files/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> UAC Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Getting Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEFINITIONS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../profiles/">Profiles</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../artifacts/">Artifacts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../multi_line_command/">Multi-line Command</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exposed_vars/">Exposed Variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../exposed_functions/">Exposed Functions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CONFIG</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../config_file/">uac.conf</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">OUTPUT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../output_formats/">Output Formats</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LOG</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Log Files</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#uaclog">uac.log</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#acquisition-log">Acquisition log</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">OTHER</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../parsing_uac_output/">Parsing UAC output</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../using_uac_with_cs_falcon_rtr/">Using UAC with CrowdStrike Falcon Real Time Response</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">UAC Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">LOG</li>
      <li class="breadcrumb-item active">Log Files</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="log-files">Log files</h1>
<h2 id="uaclog">uac.log</h2>
<p>The uac.log file contains a timestamp along with the message level and message displayed. This is the primary log that serves to preserve the actions UAC took while operating. The <code>--debug</code> option affects the level of detail that ends up in this log. When the collection finishes, this log is also archived within the output file.</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DBG</td>
<td>Debug messages</td>
</tr>
<tr>
<td>INF</td>
<td>Informational messages</td>
</tr>
<tr>
<td>ERR</td>
<td>Error messages</td>
</tr>
<tr>
<td>CMD</td>
<td>Commands executed and their stderr messages</td>
</tr>
</tbody>
</table>
<p>At the beginning of the file, UAC will record important information about the options used during execution, operating system, system architecture, mount point, configuration loaded from uac.conf file, tools and parameters available on the target system, etc (INF level).</p>
<p>Example:</p>
<pre><code class="language-text">2024-05-23 18:07:12 -0300 INF Unix-like Artifacts Collector 
2024-05-23 18:07:12 -0300 INF UAC directory: /tmp/uac
2024-05-23 18:07:12 -0300 INF Command line: ./uac -p ir_triage -u -v /tmp
2024-05-23 18:07:12 -0300 INF Operating system: linux
2024-05-23 18:07:12 -0300 INF System architecture: x86_64
2024-05-23 18:07:12 -0300 INF Hostname: uac-suse-tumbleweed
2024-05-23 18:07:12 -0300 INF Mount point: /
2024-05-23 18:07:12 -0300 INF Running as: uac
2024-05-23 18:07:12 -0300 INF Temp Directory: /tmp/uac/uac-data.tmp
2024-05-23 18:07:12 -0300 INF Output format: tar
2024-05-23 18:07:12 -0300 INF Current PID: 6377
2024-05-23 18:07:12 -0300 INF PATH: /tmp/uac/tools/date_to_epoch_pl:/tmp/uac/tools/find_pl:/tmp/uac/tools/stat_pl:/tmp/uac/tools/statx/linux/x86_64:/tmp/uac/tools/zip/esxi_linux/x86_64:/tmp/uac/bin/linux/x86_64:/tmp/uac/bin/linux:/tmp/uac/bin:/usr/xpg4/bin:/usr/xpg6/bin:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/ucb:/usr/ccs/bin:/opt/bin:/opt/sbin:/opt/local/bin:/snap/bin:/netscaler:/opt/homebrew/bin:/usr/xpg4/bin:/usr/xpg6/bin:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/ucb:/usr/ccs/bin:/opt/bin:/opt/sbin:/opt/local/bin:/snap/bin:/netscaler
2024-05-23 18:07:12 -0300 INF Loading uac.conf settings
2024-05-23 18:07:12 -0300 INF Exclude path pattern: 
2024-05-23 18:07:12 -0300 INF Exclude name pattern: 
2024-05-23 18:07:12 -0300 INF Exclude file system: 9p|afs|autofs|cifs|davfs|fuse|kernfs|nfs|nfs4|rpc_pipefs|smbfs|sysfs
2024-05-23 18:07:12 -0300 INF Hash algorithm: md5|sha1
2024-05-23 18:07:12 -0300 INF Max depth: 0
2024-05-23 18:07:12 -0300 INF Enable find mtime: true
2024-05-23 18:07:12 -0300 INF Enable find atime: false
2024-05-23 18:07:12 -0300 INF Enable find ctime: true
2024-05-23 18:07:12 -0300 INF Setting up tools and parameters
2024-05-23 18:07:12 -0300 INF find operators support: true
2024-05-23 18:07:12 -0300 INF find -path support: true
2024-05-23 18:07:12 -0300 INF find -size support: true
2024-05-23 18:07:12 -0300 INF find -maxdepth support: true
2024-05-23 18:07:12 -0300 INF find -perm support: true
2024-05-23 18:07:12 -0300 INF find -type support: true
2024-05-23 18:07:12 -0300 INF find -mtime support: true
2024-05-23 18:07:12 -0300 INF find -atime support: true
2024-05-23 18:07:12 -0300 INF find -ctime support: true
2024-05-23 18:07:12 -0300 INF find -print0 support: true
</code></pre>
<p>When the collection starts, UAC will record each command executed on the target system using the CMD level.</p>
<pre><code class="language-text">2024-05-23 18:07:12 -0300 INF Artifacts collection started
2024-05-23 18:07:12 -0300 INF Parsing live_response/process/ps.yaml
2024-05-23 18:07:12 -0300 CMD ps
2024-05-23 18:07:12 -0300 CMD ps auxwww
2024-05-23 18:07:12 -0300 CMD ps auxwwwf
2024-05-23 18:07:12 -0300 CMD ps -deaf
2024-05-23 18:07:12 -0300 CMD ps -ef
2024-05-23 18:07:12 -0300 CMD ps -efl
2024-05-23 18:07:12 -0300 CMD ps -eo pid,user,etime,args
2024-05-23 18:07:12 -0300 CMD ps -eo pid,user,lstart,args
2024-05-23 18:07:12 -0300 CMD ps -eo pid,user,cgroup
</code></pre>
<p>If the executed command generates an error message (stderr), it will be recorded on the same line following the <code>2&gt;</code> identifier.</p>
<pre><code class="language-text">2024-05-23 18:07:44 -0300 CMD uptime -s 2&gt; uptime: invalid option -- 's'/nTry 'uptime --help' for more information.
2024-05-23 18:08:04 -0300 CMD fdisk -l 2&gt; fdisk: cannot open /dev/vda: Permission denied
</code></pre>
<h2 id="acquisition-log">Acquisition log</h2>
<p>The log file generated by UAC after execution provides detailed information about the acquisition process, along with the calculated hash values (e.g., MD5, SHA-1) for the output file to ensure data integrity.</p>
<p>Example:</p>
<pre><code class="language-text">Created by UAC (Unix-like Artifacts Collector)

[Case Information]
Case Number: 42
Evidence Number: 1
Description: Web server quick triage
Examiner: Duncan
Notes: 

[System Information]
Operating System: linux
System Architecture: x86_64
Hostname: webserver01

[Acquisition Information]
Mount Point: /
Acquisition Started: Mon May 26 20:29:36 2024 -0300
Acquisition Finished: Mon May 26 20:35:56 2024 -0300

[Output Information]
File: uac-webserver01-linux-20240526202936.tar.gz
Format: tar

[Computed Hashes]
md5 checksum: 5c5305c81a13efdbb394b588da84951d
sha1 checksum: ab46c30b259bcbaa7ee9cdb64cae660d27ab98d2
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../output_formats/" class="btn btn-neutral float-left" title="Output Formats"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../parsing_uac_output/" class="btn btn-neutral float-right" title="Parsing UAC output">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../output_formats/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../parsing_uac_output/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
