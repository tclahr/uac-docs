<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://github.com/tclahr/uac/artifacts/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Artifacts - UAC Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Artifacts";
        var mkdocs_page_input_path = "artifacts.md";
        var mkdocs_page_url = "/tclahr/uac/artifacts/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> UAC Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">BASICS</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Getting Started</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">DEFINITIONS</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../profiles/">Profiles</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Artifacts</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#yaml-file-structure-overview">YAML File Structure Overview</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#version">version</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#artifacts">artifacts</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#collectors-overview">Collectors Overview</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#command">command</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#find-based-collectors">find-based collectors</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#find">find</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#hash">hash</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#stat">stat</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#file">file</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#field-reference-and-examples">Field Reference and Examples</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#command_1">command</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#compress_output_file">compress_output_file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#condition">condition</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#description">description</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exclude_file_system">exclude_file_system</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exclude_name_pattern">exclude_name_pattern</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exclude_nologin_users">exclude_nologin_users</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exclude_path_pattern">exclude_path_pattern</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#file_type">file_type</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#foreach">foreach</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ignore_date_range">ignore_date_range</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#is_file_list">is_file_list</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#max_depth">max_depth</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#max_file_size">max_file_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#min_file_size">min_file_size</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#modifier">modifier</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#name_pattern">name_pattern</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#no_group">no_group</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#no_user">no_user</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#output_directory">output_directory</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#output_file">output_file</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#path">path</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#path_pattern">path_pattern</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#permissions">permissions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#redirect_stderr_to_stdout">redirect_stderr_to_stdout</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#supported_os">supported_os</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#additional-recommendations">Additional Recommendations</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../runtime_variables/">Runtime Variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../helper_functions/">Helper Functions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">CONFIG</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../config_file/">Config Files</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">OUTPUT</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../output_formats/">Output Formats</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">LOG</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../log_files/">Log Files</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">OTHER</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../parsing_uac_output/">Parsing UAC output</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../using_uac_with_cs_falcon_rtr/">Using UAC with CrowdStrike Falcon Real Time Response</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">MISC</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../testing_lab/">Testing Lab</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">UAC Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">DEFINITIONS</li>
      <li class="breadcrumb-item active">Artifacts</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <!-- markdownlint-disable MD036 -->
<h1 id="artifacts-definition">Artifacts definition</h1>
<p>Artifacts define the parameters used by UAC collectors to gather data from the target system.</p>
<p>UAC dynamically reads YAML artifact definition files and determines which of the five available collectors to use: <a href="#command"><code>command</code></a>, <a href="#file"><code>file</code></a>, <a href="#find"><code>find</code></a>, <a href="#hash"><code>hash</code></a>, or <a href="#stat"><code>stat</code></a>. Based on the contents of each artifact, UAC collects the appropriate data and saves it to the specified output locations.</p>
<p>Each artifact file must include a <code>version</code> field and a list of artifact rules. Every rule defines how data is collected, which platforms it supports, and what collector it uses. Here's an example containing two rules, each using a different collector:</p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Hash running processes.
    supported_os: [aix]
    collector: hash
    path: /proc/[0-9]*/object/a.out
    output_directory: /live_response/process
    output_file: hash_running_processes
  -
    description: Report a snapshot of the current processes.
    supported_os: [aix, freebsd, linux, macos, netbsd, openbsd, solaris]
    collector: command
    command: ps auxwww
    output_directory: /live_response/process
    output_file: ps_auxwww.txt
</code></pre>
<p>It's a common practice to group artifacts by related topics within the same YAML file. This structure allows for more precise and efficient artifact collection tailored to your specific needs.</p>
<h2 id="yaml-file-structure-overview">YAML File Structure Overview</h2>
<h3 id="version">version</h3>
<p><strong>Required</strong></p>
<p>Indicates the version of the artifact file. Increment this value whenever you modify the file, such as by updating rules or adding new artifacts.</p>
<pre><code class="language-yaml">version: 1.0
</code></pre>
<h3 id="artifacts">artifacts</h3>
<p><strong>Required</strong></p>
<p>A list of rules specifying what to collect. Each rule must contain:</p>
<ul>
<li><code>description</code></li>
<li><code>supported_os</code></li>
<li><code>collector</code></li>
</ul>
<p>Other fields depend on the selected collector.</p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    ... # additional options depending on the collector
  -
    description: Hash files that contain at least +x flag set for owner.
    supported_os: [all]
    collector: hash
    ... # additional options depending on the collector
  -
    description: Collect /var/log logs.
    supported_os: [all]
    collector: file
    ... # additional options depending on the collector
</code></pre>
<h2 id="collectors-overview">Collectors Overview</h2>
<p>Each collector serves a specific function and comes with its own set of required and optional fields. The following sections provide a complete explanation of each collector along with practical examples.</p>
<h3 id="command">command</h3>
<p>Use the <code>command</code> collector to execute system commands and save their output to a specified file. UAC uses <code>eval</code> to run the command and captures standard output (stdout) into the defined file. Standard error (stderr) messages are written to <code>uac.log</code>, unless redirected explicitly.</p>
<p><strong>Required fields:</strong></p>
<ul>
<li><code>command</code></li>
<li><code>output_directory</code></li>
</ul>
<p><strong>Optional fields:</strong></p>
<ul>
<li><code>compress_output_file</code></li>
<li><code>condition</code></li>
<li><code>exclude_nologin_users</code></li>
<li><code>foreach</code></li>
<li><code>output_file</code></li>
<li><code>redirect_stderr_to_stdout</code></li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    command: ps auxwww
    output_directory: /live_response/process
    output_file: ps_auxwww.txt
</code></pre>
<h3 id="find-based-collectors">find-based collectors</h3>
<p>These collectors rely on the <code>find</code> tool to locate files and directories. UAC builds the appropriate <code>find</code> command dynamically at runtime based on the platform’s supported options. If unsupported options are detected or <code>find</code> is not available, UAC can use <a href="https://github.com/tclahr/find.pl">find.pl</a> as a fallback.</p>
<p><strong>Example:</strong></p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Collect nginx logs.
    supported_os: [aix, freebsd, linux, macos, netbsd, netscaler, openbsd, solaris]
    collector: file
    path: /var/log
    exclude_path_pattern: [&quot;/sys&quot;, &quot;/proc&quot;]
    name_pattern: [&quot;*access_log*&quot;, &quot;*access.log*&quot;, &quot;*error_log*&quot;, &quot;*error.log*&quot;]
    max_depth: 5
    file_type: [f]
    max_file_size: 1073741824 # 1GB
</code></pre>
<p>Resulting command with standard <code>find</code>:</p>
<pre><code class="language-shell">find /var/log -maxdepth 5 \( -path &quot;/sys&quot; -o -path &quot;/proc&quot; \) -prune -o -size -1073741824c  \( -name &quot;*access_log*&quot; -o -name &quot;*access.log*&quot; -o -name &quot;*error_log*&quot; -o -name &quot;*error.log*&quot; \) -print
</code></pre>
<p>Fallback using Perl implementation:</p>
<pre><code class="language-shell">find.pl /var/log -maxdepth 5 \( -path &quot;/sys&quot; -o -path &quot;/proc&quot; \) -prune -o -size -1073741824c  \( -name &quot;*access_log*&quot; -o -name &quot;*access.log*&quot; -o -name &quot;*error_log*&quot; -o -name &quot;*error.log*&quot; \) -print
</code></pre>
<h4 id="find">find</h4>
<p>Search for files and directories and save their paths to a text file.</p>
<p><strong>Required fields:</strong></p>
<ul>
<li><code>path</code></li>
<li><code>output_directory</code></li>
<li><code>output_file</code></li>
</ul>
<p><strong>Optional fields:</strong> Refer to the <a href="#field-reference-and-examples">field reference section</a> for a full list (e.g., <code>exclude_path_pattern</code>, <code>name_pattern</code>, etc.)</p>
<h4 id="hash">hash</h4>
<p>Generate hash values of matching files and save the results to a text file. The hash algorithm is defined in the UAC configuration file (<code>uac.conf</code>).</p>
<p><strong>Required fields:</strong></p>
<ul>
<li><code>path</code></li>
<li><code>output_directory</code></li>
<li><code>output_file</code></li>
</ul>
<p><strong>Optional fields:</strong> Refer to the <a href="#field-reference-and-examples">field reference section</a> for a full list (e.g., <code>exclude_path_pattern</code>, <code>name_pattern</code>, etc.)</p>
<h4 id="stat">stat</h4>
<p>Collect file and directory metadata to generate a body file, compatible with The Sleuth Kit (TSK). If the native <code>stat</code> tool is unavailable, UAC will use a Perl fallback <a href="https://github.com/tclahr/stat.pl">stat.pl</a>.</p>
<p><strong>Required fields:</strong></p>
<ul>
<li><code>path</code></li>
<li><code>output_directory</code></li>
<li><code>output_file</code></li>
</ul>
<p><strong>Optional fields:</strong> Refer to the <a href="#field-reference-and-examples">field reference section</a> for a full list (e.g., <code>exclude_path_pattern</code>, <code>name_pattern</code>, etc.)</p>
<h4 id="file">file</h4>
<p>Copy raw files and directories to the output archive. Files are stored in the <code>[root]</code> directory inside the output file structure.</p>
<p><strong>Required fields:</strong></p>
<ul>
<li><code>path</code></li>
</ul>
<p><strong>Optional fields:</strong> Refer to the <a href="#field-reference-and-examples">field reference section</a> for a full list (e.g., <code>exclude_path_pattern</code>, <code>name_pattern</code>, etc.)</p>
<p>Example output layout:</p>
<pre><code class="language-text">[root]
└── var
    └── log
        └── access.log
</code></pre>
<h2 id="field-reference-and-examples">Field Reference and Examples</h2>
<p>Each field used in artifact rules is described below, along with relevant examples.</p>
<h3 id="command_1">command</h3>
<p><strong>Required by: command</strong></p>
<p>Defines the shell command to execute on the target system. The command is run using <code>eval</code>, and its stdout is captured in the output file. stderr is logged to <code>uac.log</code> unless redirected.</p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    command: ps -ef
    output_directory: /live_response/process
    output_file: ps_-ef.txt
</code></pre>
<p>Multi-line commands should be enclosed in triple quotes:</p>
<pre><code class="language-yaml">command: &quot;&quot;&quot;
  for pid in /proc/[0-9]*; do 
    echo ${pid} | sed -e 's:/proc/::';
  done
&quot;&quot;&quot;
</code></pre>
<p>Use with timeout:</p>
<pre><code class="language-yaml">command: timeout.sh 2 ps -ef
</code></pre>
<h3 id="compress_output_file">compress_output_file</h3>
<p><strong>Optional for: command</strong></p>
<p>If <code>true</code>, compresses the output file using <code>gzip</code>.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/process
artifacts:
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    command: ps -ef
    output_file: ps_-ef.txt
    compress_output_file: true
</code></pre>
<h3 id="condition">condition</h3>
<p><strong>Optional for: all collectors</strong></p>
<p>Shell condition that must return success (exit 0) for the artifact to run.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/process
artifacts:
  -
    description: Collect running processes executable path.
    supported_os: [freebsd]
    condition: ls /proc/$$
    collector: command
    command: ls -l /proc/[0-9]*/file
    output_file: running_processes_full_paths.txt
</code></pre>
<p>Negation with <code>!</code>:</p>
<pre><code class="language-yaml">condition: ! ls /proc/$$
</code></pre>
<p>Global condition example. In this case, the collection will only proceed if the global condition returns true.</p>
<pre><code class="language-yaml">condition: ls /proc/$$
artifacts:
  - description: Hash running processes
    supported_os: [linux]
    ...
</code></pre>
<p>Multi-line example:</p>
<pre><code class="language-yaml">condition: &quot;&quot;&quot;
  if ls /proc/$$ &amp;&amp; ps; then
    true
  else
    false
  fi
&quot;&quot;&quot;
</code></pre>
<h3 id="description">description</h3>
<p><strong>Required</strong></p>
<p>Short text describing what the artifact does. Should not contain line breaks.</p>
<pre><code class="language-yaml">description: List current processes
</code></pre>
<h3 id="exclude_file_system">exclude_file_system</h3>
<p><strong>Optional for: file, find, hash, stat</strong></p>
<p>Exclude file systems by type. UAC retrieves the list of existing mountpoints (paths) at runtime and excludes them from the collection.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search all files excluding any files located in procfs, nfs and devfs file systems.
    supported_os: [all]
    collector: find
    path: /
    exclude_file_system: [procfs, nfs, devfs]
    output_file: exclude_procfs_nfs_devfs.txt
</code></pre>
<p><em>Note that exclude_file_system will be ignored when path_pattern is used.</em></p>
<h3 id="exclude_name_pattern">exclude_name_pattern</h3>
<p><strong>Optional</strong></p>
<p>Exclude files by name pattern. No slashes allowed in patterns.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search /etc excluding passwd and shadow* files.
    supported_os: [all]
    collector: find
    path: /etc
    exclude_name_pattern: [&quot;passwd&quot;, &quot;shadow*&quot;]
    output_file: etc_excluding_passwd_shadow.txt
</code></pre>
<h3 id="exclude_nologin_users">exclude_nologin_users</h3>
<p><strong>Optional</strong></p>
<p>When <code>true</code>, artifacts are only collected for users with a valid login shell.</p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Run 'ls -lRa' on all home directories for users that have a valid shell only.
    supported_os: [all]
    collector: command
    command: ls -lRa /%user_home%/
    exclude_nologin_users: true
    output_directory: /live_response/%user%
    output_file: ls_-lRa_%user%.txt
</code></pre>
<h3 id="exclude_path_pattern">exclude_path_pattern</h3>
<p><strong>Optional</strong></p>
<p>Exclude specific paths using shell-style patterns.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search all excluding /etc and /var.
    supported_os: [all]
    collector: find
    path: /
    exclude_path_pattern: [&quot;/dev&quot;, &quot;/var&quot;]
    output_file: all_excluding_etc_var.txt
</code></pre>
<h3 id="file_type">file_type</h3>
<p><strong>Required when <a href="#max_file_size">max_file_size</a> or <a href="#min_file_size">min_file_size</a> is specified</strong></p>
<p>Match files by type.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>f</code></td>
<td>Regular file</td>
</tr>
<tr>
<td><code>d</code></td>
<td>Directory</td>
</tr>
<tr>
<td><code>l</code></td>
<td>Symbolic link</td>
</tr>
<tr>
<td><code>p</code></td>
<td>Named pipe (FIFO)</td>
</tr>
<tr>
<td><code>s</code></td>
<td>Socket</td>
</tr>
<tr>
<td><code>b</code></td>
<td>Block special file</td>
</tr>
<tr>
<td><code>c</code></td>
<td>Character special</td>
</tr>
</tbody>
</table>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search files only.
    supported_os: [all]
    collector: find
    path: /
    file_type: [f]
    output_file: files_only.txt
  -
    description: Search directories only.
    supported_os: [all]
    collector: find
    path: /
    file_type: [f, d, l]
    output_file: directories_only.txt
</code></pre>
<h3 id="foreach">foreach</h3>
<p><strong>Optional for: command</strong></p>
<p>Run a command for each result returned by another command. Use <code>%line%</code> to substitute the line output.</p>
<p>The logic behind it is:</p>
<pre><code class="language-sh">for (each line returned by foreach); do
  command
done
</code></pre>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Fetch the logs of all containers.
    supported_os: [linux]
    collector: command
    foreach: docker container ps -all | sed 1d | awk '{print $1}'
    command: docker container logs %line%
    output_directory: /live_response/containers/%line%
    output_file: docker_container_logs_%line%.txt
</code></pre>
<p>Multi-line:</p>
<pre><code class="language-yaml">foreach: &quot;&quot;&quot;
  for pid in /proc/[0-9]*; do
    echo ${pid} | sed -e 's:/proc/::'
  done
&quot;&quot;&quot;
</code></pre>
<h3 id="ignore_date_range">ignore_date_range</h3>
<p><strong>Optional</strong></p>
<p>Ignore <code>--start-date</code> and <code>--end-date</code> arguments if <code>true</code>.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search /etc regardless date range set by --start-date and --end-date.
    supported_os: [all]
    collector: find
    path: /etc
    ignore_date_range: true
    output_file: ignore_date_range.txt
</code></pre>
<h3 id="is_file_list">is_file_list</h3>
<p><strong>Optional for: file, hash, stat</strong></p>
<p>Interpret <code>path</code> as a file that contains a list of file paths.</p>
<pre><code class="language-yaml">artifacts:
  -
    description: Hash files based on a file list located in /%uac_directory%/my_file_list.txt.
    supported_os: [all]
    collector: hash
    path: /%uac_directory%/my_file_list.txt
    is_file_list: true
    output_file: hash_my_file_list.txt
</code></pre>
<h3 id="max_depth">max_depth</h3>
<p><strong>Optional</strong></p>
<p>Limit recursion depth in directories.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Descend at most 5 levels of directories below /.
    supported_os: [all]
    collector: find
    path: /
    max_depth: 5
    output_file: max_5_levels.txt
</code></pre>
<h3 id="max_file_size">max_file_size</h3>
<p><strong>Optional</strong></p>
<p>Only include files within the specified size limits (in bytes).</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search all files smaller than 1048576 bytes.
    supported_os: [all]
    collector: find
    path: /
    max_file_size: 1048576
    output_file: smaller_than.txt
</code></pre>
<h3 id="min_file_size">min_file_size</h3>
<p><strong>Optional</strong></p>
<p>Only include files within the specified size limits (in bytes).</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search all files bigger than 1048576 bytes.
    supported_os: [all]
    collector: find
    path: /
    min_file_size: 1048576
    output_file: bigger_than.txt
</code></pre>
<h3 id="modifier">modifier</h3>
<p><strong>Optional (global)</strong></p>
<p>Mark artifact as a modifier (may alter system state). Must be enabled via <code>--enable-modifiers</code>.</p>
<pre><code class="language-yaml">version: 1.0
modifier: true
output_directory: /live_response/modifiers
artifacts:
  -
    description: List all PIDs with a directory in /proc but hidden for ps command.
    supported_os: [linux]
    collector: command
    foreach: for pid in /proc/[0-9]*; do echo ${pid} | sed -e 's:/proc/::'; done
    command: if ps ax | awk '{print $1}' | grep -q %line%; then true; else echo %line%; fi
    output_file: hidden_pids_for_ps_command.txt
  -
    description: Umount all bind mounted directories to /proc/PID.
    supported_os: [linux]
    collector: command
    foreach: mount | awk 'BEGIN { FS=&quot; on &quot;; } { print $2; }' | grep &quot;/proc/[0-9]&quot; | awk '{print $1}'
    command: umount &quot;%line%&quot;
    output_file: umount_%line%.txt
</code></pre>
<h3 id="name_pattern">name_pattern</h3>
<p><strong>Optional</strong></p>
<p>Match files by name. Wildcards and regex supported.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search all wtmp and utmp files.
    supported_os: [all]
    collector: find
    path: /var
    name_pattern: [&quot;wtmp&quot;, &quot;btmp&quot;]
    output_file: wtmp_btmp.txt
</code></pre>
<h3 id="no_group">no_group</h3>
<p><strong>Optional</strong></p>
<p>Match files with unknown GID.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: List files under /bin directory with an unknown group ID name.
    supported_os: [aix, freebsd, linux, macos, netbsd, netscaler, openbsd, solaris]
    collector: find
    path: /bin
    file_type: [f]
    no_group: true
    output_file: group_name_unknown_files.txt
</code></pre>
<h3 id="no_user">no_user</h3>
<p><strong>Optional</strong></p>
<p>Match files with unknown UID.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: List files under /bin directory with an unknown user ID name.
    supported_os: [aix, freebsd, linux, macos, netbsd, netscaler, openbsd, solaris]
    collector: find
    path: /bin
    file_type: [f]
    no_user: true
    output_file: user_name_unknown_files.txt
</code></pre>
<h3 id="output_directory">output_directory</h3>
<p><strong>Required for: command, find, hash, stat</strong></p>
<p>Specifies the internal output path in the output file.</p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: My first artifact.
    supported_os: [all]
    collector: command
    command: ls /tmp
    output_directory: /my_custom_artifacts
    output_file: ls_tmp.txt
</code></pre>
<p>Output file contents:</p>
<p><img alt="screenshot" src="../img/artifacts_md_output_directory.png" /></p>
<p>Can be defined globally:</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /my_custom_artifacts
artifacts:
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    command: ps
    output_directory: /live_response/process
    output_file: ps.txt
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    command: ps auxwww
    output_file: ps_auxwww.txt
</code></pre>
<h3 id="output_file">output_file</h3>
<p><strong>Optional</strong></p>
<p>Defines the file name inside <code>output_directory</code>. UAC appends to this file.</p>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Report a snapshot of the current processes.
    supported_os: [all]
    collector: command
    command: ps
    output_directory: /live_response/process
    output_file: ps.txt
</code></pre>
<p>If no <code>output_file</code> is specified, the output of the <code>command</code> will be stored in the <code>output_directory</code>.</p>
<p>In the example below, <code>avml.raw</code> will be placed in the <code>memory_dump</code> directory.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /memory_dump
artifacts:
  -
    description: Capture a memory image.
    supported_os: [linux]
    collector: command
    command: avml avml.raw
</code></pre>
<h3 id="path">path</h3>
<p><strong>Required for: find, file, hash, stat</strong></p>
<p>Specifies the starting point for searching or collecting files. The mount point set by <code>--mount-point</code> is automatically prepended to the path.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search all cmdline files within /proc/*/
    supported_os: [all]
    collector: find
    path: /proc/*/cmdline
    output_file: list_of_cmdline_files.txt
</code></pre>
<p>Multiple paths example:</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /system
artifacts:
  -
    description: List files under user's home directory (no recursion, top-level only) with an unknown user ID name.
    supported_os: [aix, freebsd, linux, netbsd, netscaler, openbsd]
    collector: find
    path: /home /export/home /Users /%user_home%
    max_depth: 1
    file_type: [f]
    no_user: true
    output_file: user_name_unknown_files.txt
</code></pre>
<p>Use quotation marks when specifying paths with spaces or special characters.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search for TCC.db file.
    supported_os: [all]
    collector: find
    path: /Library/&quot;Application Support&quot;/com.apple.TCC/TCC.db
    output_file: path_with_spaces.txt
</code></pre>
<h3 id="path_pattern">path_pattern</h3>
<p><strong>Optional</strong></p>
<p>Match full paths with patterns.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Find Discord cache files.
    supported_os: [all]
    collector: find
    path: /%user_home%
    path_pattern: [&quot;*/discord/Cache/*&quot;]
    output_file: discord_cache.txt
</code></pre>
<h3 id="permissions">permissions</h3>
<p><strong>Optional</strong></p>
<p>Filter files by permission bits. Symbolic mode is not supported (e.g: -g=w).</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/system
artifacts:
  -
    description: Search files that have permissions set to 755 or 644.
    supported_os: [all]
    collector: find
    path: /
    file_type: [f]
    permissions: [755, -4000]
    output_file: all_755_and_644_permissions.txt
</code></pre>
<h3 id="redirect_stderr_to_stdout">redirect_stderr_to_stdout</h3>
<p><strong>Optional for: command</strong></p>
<p>Redirect <code>stderr</code> to the output file.</p>
<pre><code class="language-yaml">version: 1.0
output_directory: /live_response/process
artifacts:
  -
    description: Collect the list open files.
    supported_os: [all]
    collector: command
    command: lsof -nPl
    output_file: lsof_-nPl.txt
    redirect_stderr_to_stdout: true
</code></pre>
<h3 id="supported_os">supported_os</h3>
<p><strong>Required</strong></p>
<p>Specifies supported operating systems.</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>all</code></td>
<td>Applies to all systems</td>
</tr>
<tr>
<td><code>aix</code></td>
<td>IBM AIX</td>
</tr>
<tr>
<td><code>esxi</code></td>
<td>VMware ESXi</td>
</tr>
<tr>
<td><code>freebsd</code></td>
<td>FreeBSD</td>
</tr>
<tr>
<td><code>linux</code></td>
<td>Linux</td>
</tr>
<tr>
<td><code>macos</code></td>
<td>macOS</td>
</tr>
<tr>
<td><code>netbsd</code></td>
<td>NetBSD</td>
</tr>
<tr>
<td><code>netscaler</code></td>
<td>NetScaler</td>
</tr>
<tr>
<td><code>openbsd</code></td>
<td>OpenBSD</td>
</tr>
<tr>
<td><code>solaris</code></td>
<td>Solaris</td>
</tr>
</tbody>
</table>
<pre><code class="language-yaml">version: 1.0
artifacts:
  -
    description: Artifact description.
    supported_os: [all]
    collector: hash
    ... # additional options depending on the collector
  -
    description: Artifact description.
    supported_os: [aix, freebsd, solaris]
    collector: stat
    ... # additional options depending on the collector
</code></pre>
<h2 id="additional-recommendations">Additional Recommendations</h2>
<ul>
<li>Enclose paths with spaces or special characters in quotes.</li>
<li>Use triple-quoted strings (<code>"""</code>) for multi-line commands or conditions.</li>
<li>Apply runtime variables like <code>%user%</code>, <code>%line%</code>, and <code>%uac_directory%</code> where applicable.</li>
<li>Maintain consistent indentation and formatting in your YAML.</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../profiles/" class="btn btn-neutral float-left" title="Profiles"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../runtime_variables/" class="btn btn-neutral float-right" title="Runtime Variables">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../profiles/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../runtime_variables/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
